{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useRef } from 'react';\nimport { collection, getDocs } from 'firebase/firestore';\nimport { db } from '../config/firebase';\nimport { lireGoogleSheets, ecrireGoogleSheets } from '../services/googleSheetsService';\nimport { demoJoueurs, demoMatchs } from '../constants/demoData';\nconst useGoogleSheets = user => {\n  _s();\n  const [joueurs, setJoueurs] = useState([]);\n  const [matchs, setMatchs] = useState([]);\n  const [convocations, setConvocations] = useState([]);\n  const [notes, setNotes] = useState([]);\n  const [buteurs, setButeurs] = useState([]);\n  const [tempsDeJeu, setTempsDeJeu] = useState([]);\n  const [passesD, setPassesD] = useState([]);\n  const [evaluationsCoach, setEvaluationsCoach] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [actionJoueurEnCours, setActionJoueurEnCours] = useState(false);\n  const isInitialLoad = useRef(true);\n  const chargerDonnees = async () => {\n    setLoading(true);\n    const [joueursData, matchsData, convocsData, notesData, buteursData, tempsData, passesData] = await Promise.all([lireGoogleSheets('Joueurs'), lireGoogleSheets('Matchs'), lireGoogleSheets('Convocations'), lireGoogleSheets('Notes'), lireGoogleSheets('Buteurs'), lireGoogleSheets('TempsDeJeu'), lireGoogleSheets('PassesD')]);\n\n    // Charger les évaluations depuis Firestore\n    try {\n      const evaluationsSnapshot = await getDocs(collection(db, 'evaluations'));\n      const evaluationsData = evaluationsSnapshot.docs.map(doc => {\n        const data = doc.data();\n        return {\n          id_joueur: parseInt(data.userId),\n          evaluateur: data.evaluateur,\n          technicite: data.technicite || 0,\n          vision: data.vision || 0,\n          collectif: data.collectif || 0,\n          mental: data.mental || 0\n        };\n      });\n      setEvaluationsCoach(evaluationsData);\n    } catch (error) {\n      console.error('Erreur chargement évaluations:', error);\n      setEvaluationsCoach([]);\n    }\n    setJoueurs(joueursData.length > 0 ? joueursData : demoJoueurs);\n    setMatchs(matchsData.length > 0 ? matchsData : demoMatchs);\n    setConvocations(convocsData);\n    setNotes(notesData);\n    setButeurs(buteursData);\n    setTempsDeJeu(tempsData);\n    setPassesD(passesData);\n    setLoading(false);\n    isInitialLoad.current = false;\n  };\n\n  // Auto-save Convocations\n  useEffect(() => {\n    if (!isInitialLoad.current && user && convocations.length > 0) {\n      if (user.role === 'coach' || user.role === 'coach_adjoint') {\n        ecrireGoogleSheets('Convocations', convocations);\n      } else if (user.role === 'joueur' && actionJoueurEnCours) {\n        ecrireGoogleSheets('Convocations', convocations);\n        setActionJoueurEnCours(false);\n      }\n    }\n  }, [convocations, user, actionJoueurEnCours]);\n\n  // Auto-save Notes\n  useEffect(() => {\n    if (!isInitialLoad.current && (user === null || user === void 0 ? void 0 : user.role) === 'coach' && notes.length > 0) {\n      ecrireGoogleSheets('Notes', notes);\n    }\n  }, [notes, user]);\n\n  // Auto-save Buteurs\n  useEffect(() => {\n    if (!isInitialLoad.current && ((user === null || user === void 0 ? void 0 : user.role) === 'coach' || (user === null || user === void 0 ? void 0 : user.role) === 'coach_adjoint') && buteurs.length > 0) {\n      ecrireGoogleSheets('Buteurs', buteurs);\n    }\n  }, [buteurs, user]);\n\n  // Auto-save Temps de jeu\n  useEffect(() => {\n    if (!isInitialLoad.current && ((user === null || user === void 0 ? void 0 : user.role) === 'coach' || (user === null || user === void 0 ? void 0 : user.role) === 'coach_adjoint') && tempsDeJeu.length > 0) {\n      ecrireGoogleSheets('TempsDeJeu', tempsDeJeu);\n    }\n  }, [tempsDeJeu, user]);\n\n  // Auto-save Passes D\n  useEffect(() => {\n    if (!isInitialLoad.current && ((user === null || user === void 0 ? void 0 : user.role) === 'coach' || (user === null || user === void 0 ? void 0 : user.role) === 'coach_adjoint') && passesD.length > 0) {\n      ecrireGoogleSheets('PassesD', passesD);\n    }\n  }, [passesD, user]);\n\n  // Auto-save Matchs\n  useEffect(() => {\n    if (!isInitialLoad.current && (user === null || user === void 0 ? void 0 : user.role) === 'coach' && matchs.length > 0) {\n      ecrireGoogleSheets('Matchs', matchs);\n    }\n  }, [matchs, user]);\n\n  // Ne PAS auto-save les évaluations dans Google Sheets\n  // Elles sont gérées uniquement dans Firestore\n\n  return {\n    joueurs,\n    setJoueurs,\n    matchs,\n    setMatchs,\n    convocations,\n    setConvocations,\n    notes,\n    setNotes,\n    buteurs,\n    setButeurs,\n    tempsDeJeu,\n    setTempsDeJeu,\n    passesD,\n    setPassesD,\n    evaluationsCoach,\n    setEvaluationsCoach,\n    loading,\n    chargerDonnees,\n    actionJoueurEnCours,\n    setActionJoueurEnCours\n  };\n};\n_s(useGoogleSheets, \"BpqM0Baiv5RLRXSO3PSorEHssKs=\");\nexport default useGoogleSheets;","map":{"version":3,"names":["useState","useEffect","useRef","collection","getDocs","db","lireGoogleSheets","ecrireGoogleSheets","demoJoueurs","demoMatchs","useGoogleSheets","user","_s","joueurs","setJoueurs","matchs","setMatchs","convocations","setConvocations","notes","setNotes","buteurs","setButeurs","tempsDeJeu","setTempsDeJeu","passesD","setPassesD","evaluationsCoach","setEvaluationsCoach","loading","setLoading","actionJoueurEnCours","setActionJoueurEnCours","isInitialLoad","chargerDonnees","joueursData","matchsData","convocsData","notesData","buteursData","tempsData","passesData","Promise","all","evaluationsSnapshot","evaluationsData","docs","map","doc","data","id_joueur","parseInt","userId","evaluateur","technicite","vision","collectif","mental","error","console","length","current","role"],"sources":["/Users/hichamghazi/Desktop/esc-cappelle/src/hooks/useGoogleSheets.js"],"sourcesContent":["import { useState, useEffect, useRef } from 'react';\nimport { collection, getDocs } from 'firebase/firestore';\nimport { db } from '../config/firebase';\nimport { lireGoogleSheets, ecrireGoogleSheets } from '../services/googleSheetsService';\nimport { demoJoueurs, demoMatchs } from '../constants/demoData';\n\nconst useGoogleSheets = (user) => {\n  const [joueurs, setJoueurs] = useState([]);\n  const [matchs, setMatchs] = useState([]);\n  const [convocations, setConvocations] = useState([]);\n  const [notes, setNotes] = useState([]);\n  const [buteurs, setButeurs] = useState([]);\n  const [tempsDeJeu, setTempsDeJeu] = useState([]);\n  const [passesD, setPassesD] = useState([]);\n  const [evaluationsCoach, setEvaluationsCoach] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [actionJoueurEnCours, setActionJoueurEnCours] = useState(false);\n\n  const isInitialLoad = useRef(true);\n\n  const chargerDonnees = async () => {\n    setLoading(true);\n    const [joueursData, matchsData, convocsData, notesData, buteursData, tempsData, passesData] = await Promise.all([\n      lireGoogleSheets('Joueurs'),\n      lireGoogleSheets('Matchs'),\n      lireGoogleSheets('Convocations'),\n      lireGoogleSheets('Notes'),\n      lireGoogleSheets('Buteurs'),\n      lireGoogleSheets('TempsDeJeu'),\n      lireGoogleSheets('PassesD')\n    ]);\n\n    // Charger les évaluations depuis Firestore\n    try {\n      const evaluationsSnapshot = await getDocs(collection(db, 'evaluations'));\n      const evaluationsData = evaluationsSnapshot.docs.map(doc => {\n        const data = doc.data();\n        return {\n          id_joueur: parseInt(data.userId),\n          evaluateur: data.evaluateur,\n          technicite: data.technicite || 0,\n          vision: data.vision || 0,\n          collectif: data.collectif || 0,\n          mental: data.mental || 0\n        };\n      });\n      setEvaluationsCoach(evaluationsData);\n    } catch (error) {\n      console.error('Erreur chargement évaluations:', error);\n      setEvaluationsCoach([]);\n    }\n\n    setJoueurs(joueursData.length > 0 ? joueursData : demoJoueurs);\n    setMatchs(matchsData.length > 0 ? matchsData : demoMatchs);\n    setConvocations(convocsData);\n    setNotes(notesData);\n    setButeurs(buteursData);\n    setTempsDeJeu(tempsData);\n    setPassesD(passesData);\n\n    setLoading(false);\n    isInitialLoad.current = false;\n  };\n\n  // Auto-save Convocations\n  useEffect(() => {\n    if (!isInitialLoad.current && user && convocations.length > 0) {\n      if (user.role === 'coach' || user.role === 'coach_adjoint') {\n        ecrireGoogleSheets('Convocations', convocations);\n      } else if (user.role === 'joueur' && actionJoueurEnCours) {\n        ecrireGoogleSheets('Convocations', convocations);\n        setActionJoueurEnCours(false);\n      }\n    }\n  }, [convocations, user, actionJoueurEnCours]);\n\n  // Auto-save Notes\n  useEffect(() => {\n    if (!isInitialLoad.current && user?.role === 'coach' && notes.length > 0) {\n      ecrireGoogleSheets('Notes', notes);\n    }\n  }, [notes, user]);\n\n  // Auto-save Buteurs\n  useEffect(() => {\n    if (!isInitialLoad.current && (user?.role === 'coach' || user?.role === 'coach_adjoint') && buteurs.length > 0) {\n      ecrireGoogleSheets('Buteurs', buteurs);\n    }\n  }, [buteurs, user]);\n\n  // Auto-save Temps de jeu\n  useEffect(() => {\n    if (!isInitialLoad.current && (user?.role === 'coach' || user?.role === 'coach_adjoint') && tempsDeJeu.length > 0) {\n      ecrireGoogleSheets('TempsDeJeu', tempsDeJeu);\n    }\n  }, [tempsDeJeu, user]);\n\n  // Auto-save Passes D\n  useEffect(() => {\n    if (!isInitialLoad.current && (user?.role === 'coach' || user?.role === 'coach_adjoint') && passesD.length > 0) {\n      ecrireGoogleSheets('PassesD', passesD);\n    }\n  }, [passesD, user]);\n\n  // Auto-save Matchs\n  useEffect(() => {\n    if (!isInitialLoad.current && user?.role === 'coach' && matchs.length > 0) {\n      ecrireGoogleSheets('Matchs', matchs);\n    }\n  }, [matchs, user]);\n\n  // Ne PAS auto-save les évaluations dans Google Sheets\n  // Elles sont gérées uniquement dans Firestore\n\n  return {\n    joueurs,\n    setJoueurs,\n    matchs,\n    setMatchs,\n    convocations,\n    setConvocations,\n    notes,\n    setNotes,\n    buteurs,\n    setButeurs,\n    tempsDeJeu,\n    setTempsDeJeu,\n    passesD,\n    setPassesD,\n    evaluationsCoach,\n    setEvaluationsCoach,\n    loading,\n    chargerDonnees,\n    actionJoueurEnCours,\n    setActionJoueurEnCours\n  };\n};\n\nexport default useGoogleSheets;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}