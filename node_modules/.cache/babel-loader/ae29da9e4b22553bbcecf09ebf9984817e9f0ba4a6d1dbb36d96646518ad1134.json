{"ast":null,"code":"import{useState,useEffect,useRef}from'react';import{lireGoogleSheets,ecrireGoogleSheets}from'../services/googleSheetsService';import{demoJoueurs,demoMatchs}from'../constants/demoData';const useGoogleSheets=user=>{const[joueurs,setJoueurs]=useState([]);const[matchs,setMatchs]=useState([]);const[convocations,setConvocations]=useState([]);const[notes,setNotes]=useState([]);const[buteurs,setButeurs]=useState([]);const[tempsDeJeu,setTempsDeJeu]=useState([]);const[passesD,setPassesD]=useState([]);const[evaluationsCoach,setEvaluationsCoach]=useState([]);const[loading,setLoading]=useState(true);const[actionJoueurEnCours,setActionJoueurEnCours]=useState(false);const isInitialLoad=useRef(true);const chargerDonnees=async()=>{setLoading(true);const[joueursData,matchsData,convocsData,notesData,buteursData,tempsData,passesData,evaluationsData]=await Promise.all([lireGoogleSheets('Joueurs'),lireGoogleSheets('Matchs'),lireGoogleSheets('Convocations'),lireGoogleSheets('Notes'),lireGoogleSheets('Buteurs'),lireGoogleSheets('TempsDeJeu'),lireGoogleSheets('PassesD'),lireGoogleSheets('EvaluationsCoach')]);setJoueurs(joueursData.length>0?joueursData:demoJoueurs);setMatchs(matchsData.length>0?matchsData:demoMatchs);setConvocations(convocsData);setNotes(notesData);setButeurs(buteursData);setTempsDeJeu(tempsData);setPassesD(passesData);setEvaluationsCoach(evaluationsData);setLoading(false);isInitialLoad.current=false;};// Auto-save Convocations\nuseEffect(()=>{if(!isInitialLoad.current&&user&&convocations.length>0){if(user.role==='coach'||user.role==='coach_adjoint'){ecrireGoogleSheets('Convocations',convocations);}else if(user.role==='joueur'&&actionJoueurEnCours){ecrireGoogleSheets('Convocations',convocations);setActionJoueurEnCours(false);}}},[convocations,user,actionJoueurEnCours]);// Auto-save Notes\nuseEffect(()=>{if(!isInitialLoad.current&&(user===null||user===void 0?void 0:user.role)==='coach'&&notes.length>0){ecrireGoogleSheets('Notes',notes);}},[notes,user]);// Auto-save Buteurs\nuseEffect(()=>{if(!isInitialLoad.current&&((user===null||user===void 0?void 0:user.role)==='coach'||(user===null||user===void 0?void 0:user.role)==='coach_adjoint')&&buteurs.length>0){ecrireGoogleSheets('Buteurs',buteurs);}},[buteurs,user]);// Auto-save Temps de jeu\nuseEffect(()=>{if(!isInitialLoad.current&&((user===null||user===void 0?void 0:user.role)==='coach'||(user===null||user===void 0?void 0:user.role)==='coach_adjoint')&&tempsDeJeu.length>0){ecrireGoogleSheets('TempsDeJeu',tempsDeJeu);}},[tempsDeJeu,user]);// Auto-save Passes D\nuseEffect(()=>{if(!isInitialLoad.current&&((user===null||user===void 0?void 0:user.role)==='coach'||(user===null||user===void 0?void 0:user.role)==='coach_adjoint')&&passesD.length>0){ecrireGoogleSheets('PassesD',passesD);}},[passesD,user]);// Auto-save Matchs\nuseEffect(()=>{if(!isInitialLoad.current&&(user===null||user===void 0?void 0:user.role)==='coach'&&matchs.length>0){ecrireGoogleSheets('Matchs',matchs);}},[matchs,user]);// Auto-save Evaluations\nuseEffect(()=>{if(!isInitialLoad.current&&(user===null||user===void 0?void 0:user.role)==='joueur'&&evaluationsCoach.length>0){ecrireGoogleSheets('EvaluationsCoach',evaluationsCoach);}},[evaluationsCoach,user]);return{joueurs,setJoueurs,matchs,setMatchs,convocations,setConvocations,notes,setNotes,buteurs,setButeurs,tempsDeJeu,setTempsDeJeu,passesD,setPassesD,evaluationsCoach,setEvaluationsCoach,loading,chargerDonnees,actionJoueurEnCours,setActionJoueurEnCours};};export default useGoogleSheets;","map":{"version":3,"names":["useState","useEffect","useRef","lireGoogleSheets","ecrireGoogleSheets","demoJoueurs","demoMatchs","useGoogleSheets","user","joueurs","setJoueurs","matchs","setMatchs","convocations","setConvocations","notes","setNotes","buteurs","setButeurs","tempsDeJeu","setTempsDeJeu","passesD","setPassesD","evaluationsCoach","setEvaluationsCoach","loading","setLoading","actionJoueurEnCours","setActionJoueurEnCours","isInitialLoad","chargerDonnees","joueursData","matchsData","convocsData","notesData","buteursData","tempsData","passesData","evaluationsData","Promise","all","length","current","role"],"sources":["/Users/hichamghazi/Desktop/esc-cappelle/src/hooks/useGoogleSheets.js"],"sourcesContent":["import { useState, useEffect, useRef } from 'react';\nimport { lireGoogleSheets, ecrireGoogleSheets } from '../services/googleSheetsService';\nimport { demoJoueurs, demoMatchs } from '../constants/demoData';\n\nconst useGoogleSheets = (user) => {\n  const [joueurs, setJoueurs] = useState([]);\n  const [matchs, setMatchs] = useState([]);\n  const [convocations, setConvocations] = useState([]);\n  const [notes, setNotes] = useState([]);\n  const [buteurs, setButeurs] = useState([]);\n  const [tempsDeJeu, setTempsDeJeu] = useState([]);\n  const [passesD, setPassesD] = useState([]);\n  const [evaluationsCoach, setEvaluationsCoach] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [actionJoueurEnCours, setActionJoueurEnCours] = useState(false);\n\n  const isInitialLoad = useRef(true);\n\n  const chargerDonnees = async () => {\n    setLoading(true);\n    const [joueursData, matchsData, convocsData, notesData, buteursData, tempsData, passesData, evaluationsData] = await Promise.all([\n      lireGoogleSheets('Joueurs'),\n      lireGoogleSheets('Matchs'),\n      lireGoogleSheets('Convocations'),\n      lireGoogleSheets('Notes'),\n      lireGoogleSheets('Buteurs'),\n      lireGoogleSheets('TempsDeJeu'),\n      lireGoogleSheets('PassesD'),\n      lireGoogleSheets('EvaluationsCoach')\n    ]);\n\n    setJoueurs(joueursData.length > 0 ? joueursData : demoJoueurs);\n    setMatchs(matchsData.length > 0 ? matchsData : demoMatchs);\n    setConvocations(convocsData);\n    setNotes(notesData);\n    setButeurs(buteursData);\n    setTempsDeJeu(tempsData);\n    setPassesD(passesData);\n    setEvaluationsCoach(evaluationsData);\n\n    setLoading(false);\n    isInitialLoad.current = false;\n  };\n\n  // Auto-save Convocations\n  useEffect(() => {\n    if (!isInitialLoad.current && user && convocations.length > 0) {\n      if (user.role === 'coach' || user.role === 'coach_adjoint') {\n        ecrireGoogleSheets('Convocations', convocations);\n      } else if (user.role === 'joueur' && actionJoueurEnCours) {\n        ecrireGoogleSheets('Convocations', convocations);\n        setActionJoueurEnCours(false);\n      }\n    }\n  }, [convocations, user, actionJoueurEnCours]);\n\n  // Auto-save Notes\n  useEffect(() => {\n    if (!isInitialLoad.current && user?.role === 'coach' && notes.length > 0) {\n      ecrireGoogleSheets('Notes', notes);\n    }\n  }, [notes, user]);\n\n  // Auto-save Buteurs\n  useEffect(() => {\n    if (!isInitialLoad.current && (user?.role === 'coach' || user?.role === 'coach_adjoint') && buteurs.length > 0) {\n      ecrireGoogleSheets('Buteurs', buteurs);\n    }\n  }, [buteurs, user]);\n\n  // Auto-save Temps de jeu\n  useEffect(() => {\n    if (!isInitialLoad.current && (user?.role === 'coach' || user?.role === 'coach_adjoint') && tempsDeJeu.length > 0) {\n      ecrireGoogleSheets('TempsDeJeu', tempsDeJeu);\n    }\n  }, [tempsDeJeu, user]);\n\n  // Auto-save Passes D\n  useEffect(() => {\n    if (!isInitialLoad.current && (user?.role === 'coach' || user?.role === 'coach_adjoint') && passesD.length > 0) {\n      ecrireGoogleSheets('PassesD', passesD);\n    }\n  }, [passesD, user]);\n\n  // Auto-save Matchs\n  useEffect(() => {\n    if (!isInitialLoad.current && user?.role === 'coach' && matchs.length > 0) {\n      ecrireGoogleSheets('Matchs', matchs);\n    }\n  }, [matchs, user]);\n\n  // Auto-save Evaluations\n  useEffect(() => {\n    if (!isInitialLoad.current && user?.role === 'joueur' && evaluationsCoach.length > 0) {\n      ecrireGoogleSheets('EvaluationsCoach', evaluationsCoach);\n    }\n  }, [evaluationsCoach, user]);\n\n  return {\n    joueurs,\n    setJoueurs,\n    matchs,\n    setMatchs,\n    convocations,\n    setConvocations,\n    notes,\n    setNotes,\n    buteurs,\n    setButeurs,\n    tempsDeJeu,\n    setTempsDeJeu,\n    passesD,\n    setPassesD,\n    evaluationsCoach,\n    setEvaluationsCoach,\n    loading,\n    chargerDonnees,\n    actionJoueurEnCours,\n    setActionJoueurEnCours\n  };\n};\n\nexport default useGoogleSheets;"],"mappings":"AAAA,OAASA,QAAQ,CAAEC,SAAS,CAAEC,MAAM,KAAQ,OAAO,CACnD,OAASC,gBAAgB,CAAEC,kBAAkB,KAAQ,iCAAiC,CACtF,OAASC,WAAW,CAAEC,UAAU,KAAQ,uBAAuB,CAE/D,KAAM,CAAAC,eAAe,CAAIC,IAAI,EAAK,CAChC,KAAM,CAACC,OAAO,CAAEC,UAAU,CAAC,CAAGV,QAAQ,CAAC,EAAE,CAAC,CAC1C,KAAM,CAACW,MAAM,CAAEC,SAAS,CAAC,CAAGZ,QAAQ,CAAC,EAAE,CAAC,CACxC,KAAM,CAACa,YAAY,CAAEC,eAAe,CAAC,CAAGd,QAAQ,CAAC,EAAE,CAAC,CACpD,KAAM,CAACe,KAAK,CAAEC,QAAQ,CAAC,CAAGhB,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACiB,OAAO,CAAEC,UAAU,CAAC,CAAGlB,QAAQ,CAAC,EAAE,CAAC,CAC1C,KAAM,CAACmB,UAAU,CAAEC,aAAa,CAAC,CAAGpB,QAAQ,CAAC,EAAE,CAAC,CAChD,KAAM,CAACqB,OAAO,CAAEC,UAAU,CAAC,CAAGtB,QAAQ,CAAC,EAAE,CAAC,CAC1C,KAAM,CAACuB,gBAAgB,CAAEC,mBAAmB,CAAC,CAAGxB,QAAQ,CAAC,EAAE,CAAC,CAC5D,KAAM,CAACyB,OAAO,CAAEC,UAAU,CAAC,CAAG1B,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAAC2B,mBAAmB,CAAEC,sBAAsB,CAAC,CAAG5B,QAAQ,CAAC,KAAK,CAAC,CAErE,KAAM,CAAA6B,aAAa,CAAG3B,MAAM,CAAC,IAAI,CAAC,CAElC,KAAM,CAAA4B,cAAc,CAAG,KAAAA,CAAA,GAAY,CACjCJ,UAAU,CAAC,IAAI,CAAC,CAChB,KAAM,CAACK,WAAW,CAAEC,UAAU,CAAEC,WAAW,CAAEC,SAAS,CAAEC,WAAW,CAAEC,SAAS,CAAEC,UAAU,CAAEC,eAAe,CAAC,CAAG,KAAM,CAAAC,OAAO,CAACC,GAAG,CAAC,CAC/HrC,gBAAgB,CAAC,SAAS,CAAC,CAC3BA,gBAAgB,CAAC,QAAQ,CAAC,CAC1BA,gBAAgB,CAAC,cAAc,CAAC,CAChCA,gBAAgB,CAAC,OAAO,CAAC,CACzBA,gBAAgB,CAAC,SAAS,CAAC,CAC3BA,gBAAgB,CAAC,YAAY,CAAC,CAC9BA,gBAAgB,CAAC,SAAS,CAAC,CAC3BA,gBAAgB,CAAC,kBAAkB,CAAC,CACrC,CAAC,CAEFO,UAAU,CAACqB,WAAW,CAACU,MAAM,CAAG,CAAC,CAAGV,WAAW,CAAG1B,WAAW,CAAC,CAC9DO,SAAS,CAACoB,UAAU,CAACS,MAAM,CAAG,CAAC,CAAGT,UAAU,CAAG1B,UAAU,CAAC,CAC1DQ,eAAe,CAACmB,WAAW,CAAC,CAC5BjB,QAAQ,CAACkB,SAAS,CAAC,CACnBhB,UAAU,CAACiB,WAAW,CAAC,CACvBf,aAAa,CAACgB,SAAS,CAAC,CACxBd,UAAU,CAACe,UAAU,CAAC,CACtBb,mBAAmB,CAACc,eAAe,CAAC,CAEpCZ,UAAU,CAAC,KAAK,CAAC,CACjBG,aAAa,CAACa,OAAO,CAAG,KAAK,CAC/B,CAAC,CAED;AACAzC,SAAS,CAAC,IAAM,CACd,GAAI,CAAC4B,aAAa,CAACa,OAAO,EAAIlC,IAAI,EAAIK,YAAY,CAAC4B,MAAM,CAAG,CAAC,CAAE,CAC7D,GAAIjC,IAAI,CAACmC,IAAI,GAAK,OAAO,EAAInC,IAAI,CAACmC,IAAI,GAAK,eAAe,CAAE,CAC1DvC,kBAAkB,CAAC,cAAc,CAAES,YAAY,CAAC,CAClD,CAAC,IAAM,IAAIL,IAAI,CAACmC,IAAI,GAAK,QAAQ,EAAIhB,mBAAmB,CAAE,CACxDvB,kBAAkB,CAAC,cAAc,CAAES,YAAY,CAAC,CAChDe,sBAAsB,CAAC,KAAK,CAAC,CAC/B,CACF,CACF,CAAC,CAAE,CAACf,YAAY,CAAEL,IAAI,CAAEmB,mBAAmB,CAAC,CAAC,CAE7C;AACA1B,SAAS,CAAC,IAAM,CACd,GAAI,CAAC4B,aAAa,CAACa,OAAO,EAAI,CAAAlC,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEmC,IAAI,IAAK,OAAO,EAAI5B,KAAK,CAAC0B,MAAM,CAAG,CAAC,CAAE,CACxErC,kBAAkB,CAAC,OAAO,CAAEW,KAAK,CAAC,CACpC,CACF,CAAC,CAAE,CAACA,KAAK,CAAEP,IAAI,CAAC,CAAC,CAEjB;AACAP,SAAS,CAAC,IAAM,CACd,GAAI,CAAC4B,aAAa,CAACa,OAAO,GAAK,CAAAlC,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEmC,IAAI,IAAK,OAAO,EAAI,CAAAnC,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEmC,IAAI,IAAK,eAAe,CAAC,EAAI1B,OAAO,CAACwB,MAAM,CAAG,CAAC,CAAE,CAC9GrC,kBAAkB,CAAC,SAAS,CAAEa,OAAO,CAAC,CACxC,CACF,CAAC,CAAE,CAACA,OAAO,CAAET,IAAI,CAAC,CAAC,CAEnB;AACAP,SAAS,CAAC,IAAM,CACd,GAAI,CAAC4B,aAAa,CAACa,OAAO,GAAK,CAAAlC,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEmC,IAAI,IAAK,OAAO,EAAI,CAAAnC,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEmC,IAAI,IAAK,eAAe,CAAC,EAAIxB,UAAU,CAACsB,MAAM,CAAG,CAAC,CAAE,CACjHrC,kBAAkB,CAAC,YAAY,CAAEe,UAAU,CAAC,CAC9C,CACF,CAAC,CAAE,CAACA,UAAU,CAAEX,IAAI,CAAC,CAAC,CAEtB;AACAP,SAAS,CAAC,IAAM,CACd,GAAI,CAAC4B,aAAa,CAACa,OAAO,GAAK,CAAAlC,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEmC,IAAI,IAAK,OAAO,EAAI,CAAAnC,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEmC,IAAI,IAAK,eAAe,CAAC,EAAItB,OAAO,CAACoB,MAAM,CAAG,CAAC,CAAE,CAC9GrC,kBAAkB,CAAC,SAAS,CAAEiB,OAAO,CAAC,CACxC,CACF,CAAC,CAAE,CAACA,OAAO,CAAEb,IAAI,CAAC,CAAC,CAEnB;AACAP,SAAS,CAAC,IAAM,CACd,GAAI,CAAC4B,aAAa,CAACa,OAAO,EAAI,CAAAlC,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEmC,IAAI,IAAK,OAAO,EAAIhC,MAAM,CAAC8B,MAAM,CAAG,CAAC,CAAE,CACzErC,kBAAkB,CAAC,QAAQ,CAAEO,MAAM,CAAC,CACtC,CACF,CAAC,CAAE,CAACA,MAAM,CAAEH,IAAI,CAAC,CAAC,CAElB;AACAP,SAAS,CAAC,IAAM,CACd,GAAI,CAAC4B,aAAa,CAACa,OAAO,EAAI,CAAAlC,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEmC,IAAI,IAAK,QAAQ,EAAIpB,gBAAgB,CAACkB,MAAM,CAAG,CAAC,CAAE,CACpFrC,kBAAkB,CAAC,kBAAkB,CAAEmB,gBAAgB,CAAC,CAC1D,CACF,CAAC,CAAE,CAACA,gBAAgB,CAAEf,IAAI,CAAC,CAAC,CAE5B,MAAO,CACLC,OAAO,CACPC,UAAU,CACVC,MAAM,CACNC,SAAS,CACTC,YAAY,CACZC,eAAe,CACfC,KAAK,CACLC,QAAQ,CACRC,OAAO,CACPC,UAAU,CACVC,UAAU,CACVC,aAAa,CACbC,OAAO,CACPC,UAAU,CACVC,gBAAgB,CAChBC,mBAAmB,CACnBC,OAAO,CACPK,cAAc,CACdH,mBAAmB,CACnBC,sBACF,CAAC,CACH,CAAC,CAED,cAAe,CAAArB,eAAe","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}