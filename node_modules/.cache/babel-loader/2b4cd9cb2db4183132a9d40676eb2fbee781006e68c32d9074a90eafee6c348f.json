{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useRef } from 'react';\nimport { collection, getDocs, doc, writeBatch } from 'firebase/firestore';\nimport { db } from '../config/firebase';\nexport const useFirestore = user => {\n  _s();\n  const [joueurs, setJoueurs] = useState([]);\n  const [matchs, setMatchs] = useState([]);\n  const [convocations, setConvocations] = useState([]);\n  const [notes, setNotes] = useState([]);\n  const [buteurs, setButeurs] = useState([]);\n  const [tempsDeJeu, setTempsDeJeu] = useState([]);\n  const [passesD, setPassesD] = useState([]);\n  const [evaluationsCoach, setEvaluationsCoach] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const hasInitialized = useRef(false);\n\n  // ============= READ FUNCTIONS =============\n\n  const loadJoueurs = async () => {\n    try {\n      const usersSnap = await getDocs(collection(db, 'users'));\n      const joueursData = usersSnap.docs.map(d => ({\n        id: d.data().id || d.id,\n        nom: d.data().nom,\n        username: d.data().username,\n        role: d.data().role\n      }));\n      setJoueurs(joueursData);\n      return joueursData;\n    } catch (error) {\n      console.error('❌ Erreur chargement joueurs:', error);\n      return [];\n    }\n  };\n  const loadMatchs = async () => {\n    try {\n      const matchsSnap = await getDocs(collection(db, 'matchs'));\n      const matchsData = matchsSnap.docs.map(d => {\n        const data = d.data();\n        return {\n          id: data.id || d.id,\n          date: data.date || '',\n          adversaire: data.adversaire || '',\n          domicile: data.domicile || 'false',\n          statut: data.statut || 'avenir',\n          scoreEquipe: data.scoreEquipe || null,\n          scoreAdversaire: data.scoreAdversaire || null\n        };\n      });\n      matchsData.sort((a, b) => {\n        const dateA = a.date.split('/').reverse().join('-');\n        const dateB = b.date.split('/').reverse().join('-');\n        return new Date(dateA) - new Date(dateB);\n      });\n      setMatchs(matchsData);\n      return matchsData;\n    } catch (error) {\n      console.error('❌ Erreur chargement matchs:', error);\n      return [];\n    }\n  };\n  const loadConvocations = async () => {\n    try {\n      const convocsSnap = await getDocs(collection(db, 'convocations'));\n      const convocsData = convocsSnap.docs.map(d => ({\n        id_match: d.data().id_match,\n        id_joueur: d.data().id_joueur,\n        convoque: d.data().convoque,\n        statut: d.data().statut\n      }));\n      setConvocations(convocsData);\n      return convocsData;\n    } catch (error) {\n      console.error('❌ Erreur chargement convocations:', error);\n      return [];\n    }\n  };\n  const loadNotes = async () => {\n    try {\n      const notesSnap = await getDocs(collection(db, 'notes'));\n      const notesData = notesSnap.docs.map(d => ({\n        id_match: d.data().id_match,\n        id_joueur: d.data().id_joueur,\n        note: d.data().note\n      }));\n      setNotes(notesData);\n      return notesData;\n    } catch (error) {\n      console.error('❌ Erreur chargement notes:', error);\n      return [];\n    }\n  };\n  const loadStats = async () => {\n    try {\n      const statsSnap = await getDocs(collection(db, 'stats'));\n      const buteursArr = [];\n      const tempsArr = [];\n      const passesArr = [];\n      statsSnap.docs.forEach(d => {\n        const data = d.data();\n        const matchId = data.id_match;\n        const userId = data.id_joueur;\n        if (data.buts > 0) {\n          buteursArr.push({\n            id_match: matchId,\n            id_joueur: userId,\n            buts: data.buts\n          });\n        }\n        if (data.temps > 0) {\n          tempsArr.push({\n            id_match: matchId,\n            id_joueur: userId,\n            temps: data.temps\n          });\n        }\n        if (data.passes > 0) {\n          passesArr.push({\n            id_match: matchId,\n            id_joueur: userId,\n            passes: data.passes\n          });\n        }\n      });\n      setButeurs(buteursArr);\n      setTempsDeJeu(tempsArr);\n      setPassesD(passesArr);\n      return {\n        buteursArr,\n        tempsArr,\n        passesArr\n      };\n    } catch (error) {\n      console.error('❌ Erreur chargement stats:', error);\n      return {\n        buteursArr: [],\n        tempsArr: [],\n        passesArr: []\n      };\n    }\n  };\n  const loadEvaluations = async () => {\n    try {\n      const evalsSnap = await getDocs(collection(db, 'evaluations'));\n      const evalsData = evalsSnap.docs.map(d => ({\n        id_joueur: d.data().id_joueur,\n        evaluateur: d.data().evaluateur,\n        technicite: d.data().technicite || 0,\n        vision: d.data().vision || 0,\n        collectif: d.data().collectif || 0,\n        mental: d.data().mental || 0\n      }));\n      setEvaluationsCoach(evalsData);\n      return evalsData;\n    } catch (error) {\n      console.error('❌ Erreur chargement évaluations:', error);\n      return [];\n    }\n  };\n\n  // ============= WRITE FUNCTIONS =============\n\n  const saveMatchs = async matchsData => {\n    if (!user || user.role !== 'coach') return;\n    try {\n      const batch = writeBatch(db);\n      for (const match of matchsData) {\n        const matchRef = doc(db, 'matchs', match.id.toString());\n        batch.set(matchRef, {\n          id: match.id,\n          date: match.date,\n          adversaire: match.adversaire,\n          domicile: match.domicile,\n          statut: match.statut,\n          scoreEquipe: match.scoreEquipe || null,\n          scoreAdversaire: match.scoreAdversaire || null,\n          updatedAt: new Date().toISOString()\n        });\n      }\n      await batch.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde matchs:', error);\n      throw error;\n    }\n  };\n  const saveConvocations = async convocsData => {\n    if (!user || user.role !== 'coach') return;\n    try {\n      // Supprimer toutes les convocations existantes\n      const existingSnap = await getDocs(collection(db, 'convocations'));\n      const batch1 = writeBatch(db);\n      existingSnap.docs.forEach(d => {\n        batch1.delete(d.ref);\n      });\n      await batch1.commit();\n\n      // Créer les nouvelles convocations\n      const batch2 = writeBatch(db);\n      convocsData.forEach(convoc => {\n        const convocRef = doc(db, 'convocations', `${convoc.id_match}_${convoc.id_joueur}`);\n        batch2.set(convocRef, {\n          id_match: convoc.id_match,\n          id_joueur: convoc.id_joueur,\n          convoque: convoc.convoque,\n          statut: convoc.statut,\n          updatedAt: new Date().toISOString()\n        });\n      });\n      await batch2.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde convocations:', error);\n      throw error;\n    }\n  };\n  const saveNotes = async notesData => {\n    if (!user || user.role !== 'coach') return;\n    try {\n      // Supprimer les notes existantes\n      const existingSnap = await getDocs(collection(db, 'notes'));\n      const batch1 = writeBatch(db);\n      existingSnap.docs.forEach(d => {\n        batch1.delete(d.ref);\n      });\n      await batch1.commit();\n\n      // Créer les nouvelles notes\n      const batch2 = writeBatch(db);\n      notesData.forEach(note => {\n        const noteRef = doc(db, 'notes', `${note.id_match}_${note.id_joueur}`);\n        batch2.set(noteRef, {\n          id_match: note.id_match,\n          id_joueur: note.id_joueur,\n          note: note.note,\n          updatedAt: new Date().toISOString()\n        });\n      });\n      await batch2.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde notes:', error);\n      throw error;\n    }\n  };\n  const saveStats = async (buteursData, tempsData, passesData) => {\n    if (!user || user.role !== 'coach') return;\n    try {\n      // Supprimer les stats existantes\n      const existingSnap = await getDocs(collection(db, 'stats'));\n      const batch1 = writeBatch(db);\n      existingSnap.docs.forEach(d => {\n        batch1.delete(d.ref);\n      });\n      await batch1.commit();\n\n      // Créer un map pour regrouper les stats par match + joueur\n      const statsMap = new Map();\n      buteursData.forEach(b => {\n        const key = `${b.id_match}_${b.id_joueur}`;\n        if (!statsMap.has(key)) {\n          statsMap.set(key, {\n            id_match: b.id_match,\n            id_joueur: b.id_joueur,\n            buts: 0,\n            temps: 0,\n            passes: 0\n          });\n        }\n        statsMap.get(key).buts = b.buts;\n      });\n      tempsData.forEach(t => {\n        const key = `${t.id_match}_${t.id_joueur}`;\n        if (!statsMap.has(key)) {\n          statsMap.set(key, {\n            id_match: t.id_match,\n            id_joueur: t.id_joueur,\n            buts: 0,\n            temps: 0,\n            passes: 0\n          });\n        }\n        statsMap.get(key).temps = t.temps;\n      });\n      passesData.forEach(p => {\n        const key = `${p.id_match}_${p.id_joueur}`;\n        if (!statsMap.has(key)) {\n          statsMap.set(key, {\n            id_match: p.id_match,\n            id_joueur: p.id_joueur,\n            buts: 0,\n            temps: 0,\n            passes: 0\n          });\n        }\n        statsMap.get(key).passes = p.passes;\n      });\n\n      // Sauvegarder toutes les stats\n      const batch2 = writeBatch(db);\n      statsMap.forEach((stat, key) => {\n        const statRef = doc(db, 'stats', key);\n        batch2.set(statRef, {\n          id_match: stat.id_match,\n          id_joueur: stat.id_joueur,\n          buts: stat.buts,\n          temps: stat.temps,\n          passes: stat.passes,\n          updatedAt: new Date().toISOString()\n        });\n      });\n      await batch2.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde stats:', error);\n      throw error;\n    }\n  };\n  const saveEvaluations = async evalsData => {\n    try {\n      // Supprimer les évaluations existantes\n      const existingSnap = await getDocs(collection(db, 'evaluations'));\n      const batch1 = writeBatch(db);\n      existingSnap.docs.forEach(d => {\n        batch1.delete(d.ref);\n      });\n      await batch1.commit();\n\n      // Créer les nouvelles évaluations\n      const batch2 = writeBatch(db);\n      evalsData.forEach(evaluation => {\n        const evalRef = doc(db, 'evaluations', `${evaluation.id_joueur}_${evaluation.evaluateur}`);\n        batch2.set(evalRef, {\n          id_joueur: evaluation.id_joueur,\n          evaluateur: evaluation.evaluateur,\n          technicite: evaluation.technicite || 0,\n          vision: evaluation.vision || 0,\n          collectif: evaluation.collectif || 0,\n          mental: evaluation.mental || 0,\n          updatedAt: new Date().toISOString()\n        });\n      });\n      await batch2.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde évaluations:', error);\n      throw error;\n    }\n  };\n\n  // ============= INITIAL LOAD =============\n\n  useEffect(() => {\n    if (!user || hasInitialized.current) return;\n    const loadData = async () => {\n      try {\n        setLoading(true);\n        await Promise.all([loadJoueurs(), loadMatchs(), loadConvocations(), loadNotes(), loadStats(), loadEvaluations()]);\n        hasInitialized.current = true;\n        setLoading(false);\n      } catch (error) {\n        console.error('❌ Erreur chargement Firestore:', error);\n        setLoading(false);\n      }\n    };\n    loadData();\n  }, [user]);\n\n  // ============= AUTO-SAVE EFFECTS =============\n\n  // Auto-save matchs (coach only)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || user.role !== 'coach' || matchs.length === 0) return;\n    saveMatchs(matchs).catch(err => console.error('Auto-save matchs failed:', err));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [matchs, user]);\n\n  // Auto-save convocations (coach only)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || user.role !== 'coach' || convocations.length === 0) return;\n    saveConvocations(convocations).catch(err => console.error('Auto-save convocations failed:', err));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [convocations, user]);\n\n  // Auto-save notes (coach only)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || user.role !== 'coach' || notes.length === 0) return;\n    saveNotes(notes).catch(err => console.error('Auto-save notes failed:', err));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [notes, user]);\n\n  // Auto-save stats (coach only)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || user.role !== 'coach') return;\n    if (buteurs.length === 0 && tempsDeJeu.length === 0 && passesD.length === 0) return;\n    saveStats(buteurs, tempsDeJeu, passesD).catch(err => console.error('Auto-save stats failed:', err));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [buteurs, tempsDeJeu, passesD, user]);\n\n  // Auto-save evaluations (tous les joueurs)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || evaluationsCoach.length === 0) return;\n    saveEvaluations(evaluationsCoach).catch(err => console.error('Auto-save evaluations failed:', err));\n  }, [evaluationsCoach, user]);\n  return {\n    joueurs,\n    matchs,\n    setMatchs,\n    convocations,\n    setConvocations,\n    notes,\n    setNotes,\n    buteurs,\n    setButeurs,\n    tempsDeJeu,\n    setTempsDeJeu,\n    passesD,\n    setPassesD,\n    evaluationsCoach,\n    setEvaluationsCoach,\n    loading,\n    loadConvocations,\n    loadMatchs,\n    loadNotes,\n    loadStats,\n    loadEvaluations\n  };\n};\n_s(useFirestore, \"hWgc4aDZEO4LXcghf0pMXbvjsHY=\");","map":{"version":3,"names":["useState","useEffect","useRef","collection","getDocs","doc","writeBatch","db","useFirestore","user","_s","joueurs","setJoueurs","matchs","setMatchs","convocations","setConvocations","notes","setNotes","buteurs","setButeurs","tempsDeJeu","setTempsDeJeu","passesD","setPassesD","evaluationsCoach","setEvaluationsCoach","loading","setLoading","hasInitialized","loadJoueurs","usersSnap","joueursData","docs","map","d","id","data","nom","username","role","error","console","loadMatchs","matchsSnap","matchsData","date","adversaire","domicile","statut","scoreEquipe","scoreAdversaire","sort","a","b","dateA","split","reverse","join","dateB","Date","loadConvocations","convocsSnap","convocsData","id_match","id_joueur","convoque","loadNotes","notesSnap","notesData","note","loadStats","statsSnap","buteursArr","tempsArr","passesArr","forEach","matchId","userId","buts","push","temps","passes","loadEvaluations","evalsSnap","evalsData","evaluateur","technicite","vision","collectif","mental","saveMatchs","batch","match","matchRef","toString","set","updatedAt","toISOString","commit","saveConvocations","existingSnap","batch1","delete","ref","batch2","convoc","convocRef","saveNotes","noteRef","saveStats","buteursData","tempsData","passesData","statsMap","Map","key","has","get","t","p","stat","statRef","saveEvaluations","evaluation","evalRef","current","loadData","Promise","all","length","catch","err"],"sources":["/Users/hichamghazi/Desktop/esc-cappelle/src/hooks/useFirestore.js"],"sourcesContent":["import { useState, useEffect, useRef } from 'react';\nimport {\n  collection,\n  getDocs,\n  doc,\n  writeBatch\n} from 'firebase/firestore';\nimport { db } from '../config/firebase';\n\nexport const useFirestore = (user) => {\n  const [joueurs, setJoueurs] = useState([]);\n  const [matchs, setMatchs] = useState([]);\n  const [convocations, setConvocations] = useState([]);\n  const [notes, setNotes] = useState([]);\n  const [buteurs, setButeurs] = useState([]);\n  const [tempsDeJeu, setTempsDeJeu] = useState([]);\n  const [passesD, setPassesD] = useState([]);\n  const [evaluationsCoach, setEvaluationsCoach] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  const hasInitialized = useRef(false);\n\n  // ============= READ FUNCTIONS =============\n\n  const loadJoueurs = async () => {\n    try {\n      const usersSnap = await getDocs(collection(db, 'users'));\n      const joueursData = usersSnap.docs.map(d => ({\n        id: d.data().id || d.id,\n        nom: d.data().nom,\n        username: d.data().username,\n        role: d.data().role\n      }));\n      setJoueurs(joueursData);\n      return joueursData;\n    } catch (error) {\n      console.error('❌ Erreur chargement joueurs:', error);\n      return [];\n    }\n  };\n\n  const loadMatchs = async () => {\n    try {\n      const matchsSnap = await getDocs(collection(db, 'matchs'));\n      const matchsData = matchsSnap.docs.map(d => {\n        const data = d.data();\n        return {\n          id: data.id || d.id,\n          date: data.date || '',\n          adversaire: data.adversaire || '',\n          domicile: data.domicile || 'false',\n          statut: data.statut || 'avenir',\n          scoreEquipe: data.scoreEquipe || null,\n          scoreAdversaire: data.scoreAdversaire || null\n        };\n      });\n      matchsData.sort((a, b) => {\n        const dateA = a.date.split('/').reverse().join('-');\n        const dateB = b.date.split('/').reverse().join('-');\n        return new Date(dateA) - new Date(dateB);\n      });\n      setMatchs(matchsData);\n      return matchsData;\n    } catch (error) {\n      console.error('❌ Erreur chargement matchs:', error);\n      return [];\n    }\n  };\n\n  const loadConvocations = async () => {\n    try {\n      const convocsSnap = await getDocs(collection(db, 'convocations'));\n      const convocsData = convocsSnap.docs.map(d => ({\n        id_match: d.data().id_match,\n        id_joueur: d.data().id_joueur,\n        convoque: d.data().convoque,\n        statut: d.data().statut\n      }));\n      setConvocations(convocsData);\n      return convocsData;\n    } catch (error) {\n      console.error('❌ Erreur chargement convocations:', error);\n      return [];\n    }\n  };\n\n  const loadNotes = async () => {\n    try {\n      const notesSnap = await getDocs(collection(db, 'notes'));\n      const notesData = notesSnap.docs.map(d => ({\n        id_match: d.data().id_match,\n        id_joueur: d.data().id_joueur,\n        note: d.data().note\n      }));\n      setNotes(notesData);\n      return notesData;\n    } catch (error) {\n      console.error('❌ Erreur chargement notes:', error);\n      return [];\n    }\n  };\n\n  const loadStats = async () => {\n    try {\n      const statsSnap = await getDocs(collection(db, 'stats'));\n      const buteursArr = [];\n      const tempsArr = [];\n      const passesArr = [];\n\n      statsSnap.docs.forEach(d => {\n        const data = d.data();\n        const matchId = data.id_match;\n        const userId = data.id_joueur;\n\n        if (data.buts > 0) {\n          buteursArr.push({ id_match: matchId, id_joueur: userId, buts: data.buts });\n        }\n        if (data.temps > 0) {\n          tempsArr.push({ id_match: matchId, id_joueur: userId, temps: data.temps });\n        }\n        if (data.passes > 0) {\n          passesArr.push({ id_match: matchId, id_joueur: userId, passes: data.passes });\n        }\n      });\n\n      setButeurs(buteursArr);\n      setTempsDeJeu(tempsArr);\n      setPassesD(passesArr);\n\n      return { buteursArr, tempsArr, passesArr };\n    } catch (error) {\n      console.error('❌ Erreur chargement stats:', error);\n      return { buteursArr: [], tempsArr: [], passesArr: [] };\n    }\n  };\n\n  const loadEvaluations = async () => {\n    try {\n      const evalsSnap = await getDocs(collection(db, 'evaluations'));\n      const evalsData = evalsSnap.docs.map(d => ({\n        id_joueur: d.data().id_joueur,\n        evaluateur: d.data().evaluateur,\n        technicite: d.data().technicite || 0,\n        vision: d.data().vision || 0,\n        collectif: d.data().collectif || 0,\n        mental: d.data().mental || 0\n      }));\n      setEvaluationsCoach(evalsData);\n      return evalsData;\n    } catch (error) {\n      console.error('❌ Erreur chargement évaluations:', error);\n      return [];\n    }\n  };\n\n  // ============= WRITE FUNCTIONS =============\n\n  const saveMatchs = async (matchsData) => {\n    if (!user || user.role !== 'coach') return;\n\n    try {\n      const batch = writeBatch(db);\n\n      for (const match of matchsData) {\n        const matchRef = doc(db, 'matchs', match.id.toString());\n        batch.set(matchRef, {\n          id: match.id,\n          date: match.date,\n          adversaire: match.adversaire,\n          domicile: match.domicile,\n          statut: match.statut,\n          scoreEquipe: match.scoreEquipe || null,\n          scoreAdversaire: match.scoreAdversaire || null,\n          updatedAt: new Date().toISOString()\n        });\n      }\n\n      await batch.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde matchs:', error);\n      throw error;\n    }\n  };\n\n  const saveConvocations = async (convocsData) => {\n    if (!user || user.role !== 'coach') return;\n\n    try {\n      // Supprimer toutes les convocations existantes\n      const existingSnap = await getDocs(collection(db, 'convocations'));\n      const batch1 = writeBatch(db);\n      existingSnap.docs.forEach(d => {\n        batch1.delete(d.ref);\n      });\n      await batch1.commit();\n\n      // Créer les nouvelles convocations\n      const batch2 = writeBatch(db);\n      convocsData.forEach((convoc) => {\n        const convocRef = doc(db, 'convocations', `${convoc.id_match}_${convoc.id_joueur}`);\n        batch2.set(convocRef, {\n          id_match: convoc.id_match,\n          id_joueur: convoc.id_joueur,\n          convoque: convoc.convoque,\n          statut: convoc.statut,\n          updatedAt: new Date().toISOString()\n        });\n      });\n\n      await batch2.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde convocations:', error);\n      throw error;\n    }\n  };\n\n  const saveNotes = async (notesData) => {\n    if (!user || user.role !== 'coach') return;\n\n    try {\n      // Supprimer les notes existantes\n      const existingSnap = await getDocs(collection(db, 'notes'));\n      const batch1 = writeBatch(db);\n      existingSnap.docs.forEach(d => {\n        batch1.delete(d.ref);\n      });\n      await batch1.commit();\n\n      // Créer les nouvelles notes\n      const batch2 = writeBatch(db);\n      notesData.forEach(note => {\n        const noteRef = doc(db, 'notes', `${note.id_match}_${note.id_joueur}`);\n        batch2.set(noteRef, {\n          id_match: note.id_match,\n          id_joueur: note.id_joueur,\n          note: note.note,\n          updatedAt: new Date().toISOString()\n        });\n      });\n\n      await batch2.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde notes:', error);\n      throw error;\n    }\n  };\n\n  const saveStats = async (buteursData, tempsData, passesData) => {\n    if (!user || user.role !== 'coach') return;\n\n    try {\n      // Supprimer les stats existantes\n      const existingSnap = await getDocs(collection(db, 'stats'));\n      const batch1 = writeBatch(db);\n      existingSnap.docs.forEach(d => {\n        batch1.delete(d.ref);\n      });\n      await batch1.commit();\n\n      // Créer un map pour regrouper les stats par match + joueur\n      const statsMap = new Map();\n\n      buteursData.forEach(b => {\n        const key = `${b.id_match}_${b.id_joueur}`;\n        if (!statsMap.has(key)) {\n          statsMap.set(key, { id_match: b.id_match, id_joueur: b.id_joueur, buts: 0, temps: 0, passes: 0 });\n        }\n        statsMap.get(key).buts = b.buts;\n      });\n\n      tempsData.forEach(t => {\n        const key = `${t.id_match}_${t.id_joueur}`;\n        if (!statsMap.has(key)) {\n          statsMap.set(key, { id_match: t.id_match, id_joueur: t.id_joueur, buts: 0, temps: 0, passes: 0 });\n        }\n        statsMap.get(key).temps = t.temps;\n      });\n\n      passesData.forEach(p => {\n        const key = `${p.id_match}_${p.id_joueur}`;\n        if (!statsMap.has(key)) {\n          statsMap.set(key, { id_match: p.id_match, id_joueur: p.id_joueur, buts: 0, temps: 0, passes: 0 });\n        }\n        statsMap.get(key).passes = p.passes;\n      });\n\n      // Sauvegarder toutes les stats\n      const batch2 = writeBatch(db);\n      statsMap.forEach((stat, key) => {\n        const statRef = doc(db, 'stats', key);\n        batch2.set(statRef, {\n          id_match: stat.id_match,\n          id_joueur: stat.id_joueur,\n          buts: stat.buts,\n          temps: stat.temps,\n          passes: stat.passes,\n          updatedAt: new Date().toISOString()\n        });\n      });\n\n      await batch2.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde stats:', error);\n      throw error;\n    }\n  };\n\n  const saveEvaluations = async (evalsData) => {\n    try {\n      // Supprimer les évaluations existantes\n      const existingSnap = await getDocs(collection(db, 'evaluations'));\n      const batch1 = writeBatch(db);\n      existingSnap.docs.forEach(d => {\n        batch1.delete(d.ref);\n      });\n      await batch1.commit();\n\n      // Créer les nouvelles évaluations\n      const batch2 = writeBatch(db);\n      evalsData.forEach(evaluation => {\n        const evalRef = doc(db, 'evaluations', `${evaluation.id_joueur}_${evaluation.evaluateur}`);\n        batch2.set(evalRef, {\n          id_joueur: evaluation.id_joueur,\n          evaluateur: evaluation.evaluateur,\n          technicite: evaluation.technicite || 0,\n          vision: evaluation.vision || 0,\n          collectif: evaluation.collectif || 0,\n          mental: evaluation.mental || 0,\n          updatedAt: new Date().toISOString()\n        });\n      });\n\n      await batch2.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde évaluations:', error);\n      throw error;\n    }\n  };\n\n  // ============= INITIAL LOAD =============\n\n  useEffect(() => {\n    if (!user || hasInitialized.current) return;\n\n    const loadData = async () => {\n      try {\n        setLoading(true);\n        await Promise.all([\n          loadJoueurs(),\n          loadMatchs(),\n          loadConvocations(),\n          loadNotes(),\n          loadStats(),\n          loadEvaluations()\n        ]);\n        hasInitialized.current = true;\n        setLoading(false);\n      } catch (error) {\n        console.error('❌ Erreur chargement Firestore:', error);\n        setLoading(false);\n      }\n    };\n\n    loadData();\n  }, [user]);\n\n  // ============= AUTO-SAVE EFFECTS =============\n\n  // Auto-save matchs (coach only)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || user.role !== 'coach' || matchs.length === 0) return;\n    saveMatchs(matchs).catch(err => console.error('Auto-save matchs failed:', err));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [matchs, user]);\n\n  // Auto-save convocations (coach only)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || user.role !== 'coach' || convocations.length === 0) return;\n    saveConvocations(convocations).catch(err => console.error('Auto-save convocations failed:', err));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [convocations, user]);\n\n  // Auto-save notes (coach only)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || user.role !== 'coach' || notes.length === 0) return;\n    saveNotes(notes).catch(err => console.error('Auto-save notes failed:', err));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [notes, user]);\n\n  // Auto-save stats (coach only)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || user.role !== 'coach') return;\n    if (buteurs.length === 0 && tempsDeJeu.length === 0 && passesD.length === 0) return;\n    saveStats(buteurs, tempsDeJeu, passesD).catch(err => console.error('Auto-save stats failed:', err));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [buteurs, tempsDeJeu, passesD, user]);\n\n  // Auto-save evaluations (tous les joueurs)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || evaluationsCoach.length === 0) return;\n    saveEvaluations(evaluationsCoach).catch(err => console.error('Auto-save evaluations failed:', err));\n  }, [evaluationsCoach, user]);\n\n  return {\n    joueurs,\n    matchs,\n    setMatchs,\n    convocations,\n    setConvocations,\n    notes,\n    setNotes,\n    buteurs,\n    setButeurs,\n    tempsDeJeu,\n    setTempsDeJeu,\n    passesD,\n    setPassesD,\n    evaluationsCoach,\n    setEvaluationsCoach,\n    loading,\n    loadConvocations,\n    loadMatchs,\n    loadNotes,\n    loadStats,\n    loadEvaluations\n  };\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}