{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useRef } from 'react';\nimport { collection, getDocs, doc, writeBatch } from 'firebase/firestore';\nimport { db } from '../config/firebase';\nexport const useFirestore = user => {\n  _s();\n  const [joueurs, setJoueurs] = useState([]);\n  const [matchs, setMatchs] = useState([]);\n  const [convocations, setConvocations] = useState([]);\n  const [notes, setNotes] = useState([]);\n  const [buteurs, setButeurs] = useState([]);\n  const [tempsDeJeu, setTempsDeJeu] = useState([]);\n  const [passesD, setPassesD] = useState([]);\n  const [evaluationsCoach, setEvaluationsCoach] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const hasInitialized = useRef(false);\n\n  // ============= READ FUNCTIONS =============\n\n  const loadJoueurs = async () => {\n    try {\n      const usersSnap = await getDocs(collection(db, 'users'));\n      const joueursData = usersSnap.docs.map(d => ({\n        id: String(d.data().id || d.id),\n        // Convertir en string pour matcher notes/stats\n        nom: d.data().nom,\n        username: d.data().username,\n        role: d.data().role\n      }));\n      setJoueurs(joueursData);\n      return joueursData;\n    } catch (error) {\n      console.error('❌ Erreur chargement joueurs:', error);\n      return [];\n    }\n  };\n  const loadMatchs = async () => {\n    try {\n      const matchsSnap = await getDocs(collection(db, 'matchs'));\n      const matchsData = matchsSnap.docs.map(d => {\n        const data = d.data();\n        return {\n          id: data.id || d.id,\n          date: data.date || '',\n          adversaire: data.adversaire || '',\n          domicile: data.domicile || 'false',\n          statut: data.statut || 'avenir',\n          scoreEquipe: data.scoreEquipe || null,\n          scoreAdversaire: data.scoreAdversaire || null\n        };\n      });\n      matchsData.sort((a, b) => {\n        const dateA = a.date.split('/').reverse().join('-');\n        const dateB = b.date.split('/').reverse().join('-');\n        return new Date(dateA) - new Date(dateB);\n      });\n      setMatchs(matchsData);\n      return matchsData;\n    } catch (error) {\n      console.error('❌ Erreur chargement matchs:', error);\n      return [];\n    }\n  };\n  const loadConvocations = async () => {\n    try {\n      const convocsSnap = await getDocs(collection(db, 'convocations'));\n      const convocsData = convocsSnap.docs.map(d => ({\n        id_match: d.data().id_match,\n        id_joueur: d.data().id_joueur,\n        convoque: d.data().convoque,\n        statut: d.data().statut\n      }));\n      setConvocations(convocsData);\n      return convocsData;\n    } catch (error) {\n      console.error('❌ Erreur chargement convocations:', error);\n      return [];\n    }\n  };\n  const loadNotes = async () => {\n    try {\n      const notesSnap = await getDocs(collection(db, 'notes'));\n      const notesData = notesSnap.docs.map(d => {\n        const noteStr = String(d.data().note || '0').replace(',', '.'); // Remplacer virgule par point\n        return {\n          id_match: d.data().id_match,\n          id_joueur: d.data().id_joueur,\n          note: parseFloat(noteStr) || 0\n        };\n      });\n      setNotes(notesData);\n      return notesData;\n    } catch (error) {\n      console.error('❌ Erreur chargement notes:', error);\n      return [];\n    }\n  };\n  const loadStats = async () => {\n    try {\n      const statsSnap = await getDocs(collection(db, 'stats'));\n      const buteursArr = [];\n      const tempsArr = [];\n      const passesArr = [];\n      statsSnap.docs.forEach(d => {\n        const data = d.data();\n        const matchId = data.id_match;\n        const userId = data.id_joueur;\n\n        // Convertir en nombres\n        const buts = parseInt(data.buts) || 0;\n        const temps = parseInt(data.temps) || 0;\n        const passes = parseInt(data.passes) || 0;\n        if (buts > 0) {\n          buteursArr.push({\n            id_match: matchId,\n            id_joueur: userId,\n            buts\n          });\n        }\n        if (temps > 0) {\n          tempsArr.push({\n            id_match: matchId,\n            id_joueur: userId,\n            temps\n          });\n        }\n        if (passes > 0) {\n          passesArr.push({\n            id_match: matchId,\n            id_joueur: userId,\n            passes\n          });\n        }\n      });\n      setButeurs(buteursArr);\n      setTempsDeJeu(tempsArr);\n      setPassesD(passesArr);\n      return {\n        buteursArr,\n        tempsArr,\n        passesArr\n      };\n    } catch (error) {\n      console.error('❌ Erreur chargement stats:', error);\n      return {\n        buteursArr: [],\n        tempsArr: [],\n        passesArr: []\n      };\n    }\n  };\n  const loadEvaluations = async () => {\n    try {\n      const evalsSnap = await getDocs(collection(db, 'evaluations'));\n      const evalsData = evalsSnap.docs.map(d => {\n        const data = d.data();\n        return {\n          id_joueur: String(data.id_joueur),\n          // Convertir en string\n          id_coach: String(data.id_coach),\n          // Convertir en string\n          entrainements: parseFloat(String(data.entrainements || '0').replace(',', '.')) || 0,\n          coaching: parseFloat(String(data.coaching || '0').replace(',', '.')) || 0,\n          relation: parseFloat(String(data.relation || '0').replace(',', '.')) || 0,\n          note_globale: parseFloat(String(data.note_globale || '0').replace(',', '.')) || 0\n        };\n      });\n      setEvaluationsCoach(evalsData);\n      return evalsData;\n    } catch (error) {\n      console.error('❌ Erreur chargement évaluations:', error);\n      return [];\n    }\n  };\n\n  // ============= WRITE FUNCTIONS =============\n\n  const saveMatchs = async matchsData => {\n    if (!user || user.role !== 'coach') return;\n    try {\n      const batch = writeBatch(db);\n      for (const match of matchsData) {\n        const matchRef = doc(db, 'matchs', match.id.toString());\n        batch.set(matchRef, {\n          id: match.id,\n          date: match.date,\n          adversaire: match.adversaire,\n          domicile: match.domicile,\n          statut: match.statut,\n          scoreEquipe: match.scoreEquipe || null,\n          scoreAdversaire: match.scoreAdversaire || null,\n          updatedAt: new Date().toISOString()\n        });\n      }\n      await batch.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde matchs:', error);\n      throw error;\n    }\n  };\n  const saveConvocations = async convocsData => {\n    if (!user || user.role !== 'coach') return;\n    if (!convocsData || convocsData.length === 0) return; // Skip si vide\n\n    try {\n      // Filtrer les convocations valides (pas de undefined)\n      const validConvocs = convocsData.filter(c => c.id_match !== undefined && c.id_joueur !== undefined);\n      if (validConvocs.length === 0) return; // Skip si aucune valide\n\n      // Supprimer toutes les convocations existantes\n      const existingSnap = await getDocs(collection(db, 'convocations'));\n      const batch1 = writeBatch(db);\n      existingSnap.docs.forEach(d => {\n        batch1.delete(d.ref);\n      });\n      await batch1.commit();\n\n      // Créer les nouvelles convocations\n      const batch2 = writeBatch(db);\n      validConvocs.forEach(convoc => {\n        const convocRef = doc(db, 'convocations', `${convoc.id_match}_${convoc.id_joueur}`);\n        batch2.set(convocRef, {\n          id_match: convoc.id_match,\n          id_joueur: convoc.id_joueur,\n          convoque: convoc.convoque,\n          statut: convoc.statut,\n          updatedAt: new Date().toISOString()\n        });\n      });\n      await batch2.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde convocations:', error);\n      throw error;\n    }\n  };\n  const saveNotes = async notesData => {\n    if (!user || user.role !== 'coach') return;\n    if (!notesData || notesData.length === 0) return; // Skip si vide\n\n    try {\n      // Filtrer les notes valides (pas de undefined)\n      const validNotes = notesData.filter(n => n.id_match !== undefined && n.id_joueur !== undefined);\n      if (validNotes.length === 0) return; // Skip si aucune valide\n\n      // Supprimer les notes existantes\n      const existingSnap = await getDocs(collection(db, 'notes'));\n      const batch1 = writeBatch(db);\n      existingSnap.docs.forEach(d => {\n        batch1.delete(d.ref);\n      });\n      await batch1.commit();\n\n      // Créer les nouvelles notes\n      const batch2 = writeBatch(db);\n      validNotes.forEach(note => {\n        const noteRef = doc(db, 'notes', `${note.id_match}_${note.id_joueur}`);\n        batch2.set(noteRef, {\n          id_match: note.id_match,\n          id_joueur: note.id_joueur,\n          note: note.note,\n          updatedAt: new Date().toISOString()\n        });\n      });\n      await batch2.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde notes:', error);\n      throw error;\n    }\n  };\n  const saveStats = async (buteursData, tempsData, passesData) => {\n    if (!user || user.role !== 'coach') return;\n\n    // Skip si tous les tableaux sont vides\n    if ((!buteursData || buteursData.length === 0) && (!tempsData || tempsData.length === 0) && (!passesData || passesData.length === 0)) {\n      return;\n    }\n    try {\n      // Supprimer les stats existantes\n      const existingSnap = await getDocs(collection(db, 'stats'));\n      const batch1 = writeBatch(db);\n      existingSnap.docs.forEach(d => {\n        batch1.delete(d.ref);\n      });\n      await batch1.commit();\n\n      // Créer un map pour regrouper les stats par match + joueur\n      const statsMap = new Map();\n\n      // Filtrer et ajouter les buteurs valides\n      (buteursData || []).filter(b => b.id_match !== undefined && b.id_joueur !== undefined).forEach(b => {\n        const key = `${b.id_match}_${b.id_joueur}`;\n        if (!statsMap.has(key)) {\n          statsMap.set(key, {\n            id_match: b.id_match,\n            id_joueur: b.id_joueur,\n            buts: 0,\n            temps: 0,\n            passes: 0\n          });\n        }\n        statsMap.get(key).buts = b.buts;\n      });\n\n      // Filtrer et ajouter les temps de jeu valides\n      (tempsData || []).filter(t => t.id_match !== undefined && t.id_joueur !== undefined).forEach(t => {\n        const key = `${t.id_match}_${t.id_joueur}`;\n        if (!statsMap.has(key)) {\n          statsMap.set(key, {\n            id_match: t.id_match,\n            id_joueur: t.id_joueur,\n            buts: 0,\n            temps: 0,\n            passes: 0\n          });\n        }\n        statsMap.get(key).temps = t.temps;\n      });\n\n      // Filtrer et ajouter les passes valides\n      (passesData || []).filter(p => p.id_match !== undefined && p.id_joueur !== undefined).forEach(p => {\n        const key = `${p.id_match}_${p.id_joueur}`;\n        if (!statsMap.has(key)) {\n          statsMap.set(key, {\n            id_match: p.id_match,\n            id_joueur: p.id_joueur,\n            buts: 0,\n            temps: 0,\n            passes: 0\n          });\n        }\n        statsMap.get(key).passes = p.passes;\n      });\n\n      // Skip si aucune stat valide\n      if (statsMap.size === 0) return;\n\n      // Sauvegarder toutes les stats\n      const batch2 = writeBatch(db);\n      statsMap.forEach((stat, key) => {\n        const statRef = doc(db, 'stats', key);\n        batch2.set(statRef, {\n          id_match: stat.id_match,\n          id_joueur: stat.id_joueur,\n          buts: stat.buts,\n          temps: stat.temps,\n          passes: stat.passes,\n          updatedAt: new Date().toISOString()\n        });\n      });\n      await batch2.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde stats:', error);\n      throw error;\n    }\n  };\n  const saveEvaluations = async evalsData => {\n    try {\n      // Supprimer les évaluations existantes\n      const existingSnap = await getDocs(collection(db, 'evaluations'));\n      const batch1 = writeBatch(db);\n      existingSnap.docs.forEach(d => {\n        batch1.delete(d.ref);\n      });\n      await batch1.commit();\n\n      // Créer les nouvelles évaluations\n      const batch2 = writeBatch(db);\n      evalsData.forEach(evaluation => {\n        const evalRef = doc(db, 'evaluations', `${evaluation.id_joueur}_${evaluation.id_coach}`);\n        batch2.set(evalRef, {\n          id_joueur: evaluation.id_joueur,\n          id_coach: evaluation.id_coach,\n          entrainements: evaluation.entrainements || 0,\n          coaching: evaluation.coaching || 0,\n          relation: evaluation.relation || 0,\n          note_globale: evaluation.note_globale || 0,\n          updatedAt: new Date().toISOString()\n        });\n      });\n      await batch2.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde évaluations:', error);\n      throw error;\n    }\n  };\n\n  // ============= INITIAL LOAD =============\n\n  useEffect(() => {\n    if (!user || hasInitialized.current) return;\n    const loadData = async () => {\n      try {\n        setLoading(true);\n        await Promise.all([loadJoueurs(), loadMatchs(), loadConvocations(), loadNotes(), loadStats(), loadEvaluations()]);\n        hasInitialized.current = true;\n        setLoading(false);\n      } catch (error) {\n        console.error('❌ Erreur chargement Firestore:', error);\n        setLoading(false);\n      }\n    };\n    loadData();\n  }, [user]);\n\n  // ============= AUTO-SAVE EFFECTS =============\n\n  // Auto-save matchs (coach only)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || user.role !== 'coach' || matchs.length === 0) return;\n    saveMatchs(matchs).catch(err => console.error('Auto-save matchs failed:', err));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [matchs, user]);\n\n  // Auto-save convocations (coach only)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || user.role !== 'coach' || convocations.length === 0) return;\n    saveConvocations(convocations).catch(err => console.error('Auto-save convocations failed:', err));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [convocations, user]);\n\n  // Auto-save notes (coach only)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || user.role !== 'coach' || notes.length === 0) return;\n    saveNotes(notes).catch(err => console.error('Auto-save notes failed:', err));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [notes, user]);\n\n  // Auto-save stats (coach only)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || user.role !== 'coach') return;\n    if (buteurs.length === 0 && tempsDeJeu.length === 0 && passesD.length === 0) return;\n    saveStats(buteurs, tempsDeJeu, passesD).catch(err => console.error('Auto-save stats failed:', err));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [buteurs, tempsDeJeu, passesD, user]);\n\n  // Auto-save evaluations (tous les joueurs)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || evaluationsCoach.length === 0) return;\n    saveEvaluations(evaluationsCoach).catch(err => console.error('Auto-save evaluations failed:', err));\n  }, [evaluationsCoach, user]);\n  return {\n    joueurs,\n    matchs,\n    setMatchs,\n    convocations,\n    setConvocations,\n    notes,\n    setNotes,\n    buteurs,\n    setButeurs,\n    tempsDeJeu,\n    setTempsDeJeu,\n    passesD,\n    setPassesD,\n    evaluationsCoach,\n    setEvaluationsCoach,\n    loading,\n    loadConvocations,\n    loadMatchs,\n    loadNotes,\n    loadStats,\n    loadEvaluations\n  };\n};\n_s(useFirestore, \"hWgc4aDZEO4LXcghf0pMXbvjsHY=\");","map":{"version":3,"names":["useState","useEffect","useRef","collection","getDocs","doc","writeBatch","db","useFirestore","user","_s","joueurs","setJoueurs","matchs","setMatchs","convocations","setConvocations","notes","setNotes","buteurs","setButeurs","tempsDeJeu","setTempsDeJeu","passesD","setPassesD","evaluationsCoach","setEvaluationsCoach","loading","setLoading","hasInitialized","loadJoueurs","usersSnap","joueursData","docs","map","d","id","String","data","nom","username","role","error","console","loadMatchs","matchsSnap","matchsData","date","adversaire","domicile","statut","scoreEquipe","scoreAdversaire","sort","a","b","dateA","split","reverse","join","dateB","Date","loadConvocations","convocsSnap","convocsData","id_match","id_joueur","convoque","loadNotes","notesSnap","notesData","noteStr","note","replace","parseFloat","loadStats","statsSnap","buteursArr","tempsArr","passesArr","forEach","matchId","userId","buts","parseInt","temps","passes","push","loadEvaluations","evalsSnap","evalsData","id_coach","entrainements","coaching","relation","note_globale","saveMatchs","batch","match","matchRef","toString","set","updatedAt","toISOString","commit","saveConvocations","length","validConvocs","filter","c","undefined","existingSnap","batch1","delete","ref","batch2","convoc","convocRef","saveNotes","validNotes","n","noteRef","saveStats","buteursData","tempsData","passesData","statsMap","Map","key","has","get","t","p","size","stat","statRef","saveEvaluations","evaluation","evalRef","current","loadData","Promise","all","catch","err"],"sources":["/Users/hichamghazi/Desktop/esc-cappelle/src/hooks/useFirestore.js"],"sourcesContent":["import { useState, useEffect, useRef } from 'react';\nimport {\n  collection,\n  getDocs,\n  doc,\n  writeBatch\n} from 'firebase/firestore';\nimport { db } from '../config/firebase';\n\nexport const useFirestore = (user) => {\n  const [joueurs, setJoueurs] = useState([]);\n  const [matchs, setMatchs] = useState([]);\n  const [convocations, setConvocations] = useState([]);\n  const [notes, setNotes] = useState([]);\n  const [buteurs, setButeurs] = useState([]);\n  const [tempsDeJeu, setTempsDeJeu] = useState([]);\n  const [passesD, setPassesD] = useState([]);\n  const [evaluationsCoach, setEvaluationsCoach] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  const hasInitialized = useRef(false);\n\n  // ============= READ FUNCTIONS =============\n\n  const loadJoueurs = async () => {\n    try {\n      const usersSnap = await getDocs(collection(db, 'users'));\n      const joueursData = usersSnap.docs.map(d => ({\n        id: String(d.data().id || d.id), // Convertir en string pour matcher notes/stats\n        nom: d.data().nom,\n        username: d.data().username,\n        role: d.data().role\n      }));\n      setJoueurs(joueursData);\n      return joueursData;\n    } catch (error) {\n      console.error('❌ Erreur chargement joueurs:', error);\n      return [];\n    }\n  };\n\n  const loadMatchs = async () => {\n    try {\n      const matchsSnap = await getDocs(collection(db, 'matchs'));\n      const matchsData = matchsSnap.docs.map(d => {\n        const data = d.data();\n        return {\n          id: data.id || d.id,\n          date: data.date || '',\n          adversaire: data.adversaire || '',\n          domicile: data.domicile || 'false',\n          statut: data.statut || 'avenir',\n          scoreEquipe: data.scoreEquipe || null,\n          scoreAdversaire: data.scoreAdversaire || null\n        };\n      });\n      matchsData.sort((a, b) => {\n        const dateA = a.date.split('/').reverse().join('-');\n        const dateB = b.date.split('/').reverse().join('-');\n        return new Date(dateA) - new Date(dateB);\n      });\n      setMatchs(matchsData);\n      return matchsData;\n    } catch (error) {\n      console.error('❌ Erreur chargement matchs:', error);\n      return [];\n    }\n  };\n\n  const loadConvocations = async () => {\n    try {\n      const convocsSnap = await getDocs(collection(db, 'convocations'));\n      const convocsData = convocsSnap.docs.map(d => ({\n        id_match: d.data().id_match,\n        id_joueur: d.data().id_joueur,\n        convoque: d.data().convoque,\n        statut: d.data().statut\n      }));\n      setConvocations(convocsData);\n      return convocsData;\n    } catch (error) {\n      console.error('❌ Erreur chargement convocations:', error);\n      return [];\n    }\n  };\n\n  const loadNotes = async () => {\n    try {\n      const notesSnap = await getDocs(collection(db, 'notes'));\n      const notesData = notesSnap.docs.map(d => {\n        const noteStr = String(d.data().note || '0').replace(',', '.'); // Remplacer virgule par point\n        return {\n          id_match: d.data().id_match,\n          id_joueur: d.data().id_joueur,\n          note: parseFloat(noteStr) || 0\n        };\n      });\n      setNotes(notesData);\n      return notesData;\n    } catch (error) {\n      console.error('❌ Erreur chargement notes:', error);\n      return [];\n    }\n  };\n\n  const loadStats = async () => {\n    try {\n      const statsSnap = await getDocs(collection(db, 'stats'));\n      const buteursArr = [];\n      const tempsArr = [];\n      const passesArr = [];\n\n      statsSnap.docs.forEach(d => {\n        const data = d.data();\n        const matchId = data.id_match;\n        const userId = data.id_joueur;\n\n        // Convertir en nombres\n        const buts = parseInt(data.buts) || 0;\n        const temps = parseInt(data.temps) || 0;\n        const passes = parseInt(data.passes) || 0;\n\n        if (buts > 0) {\n          buteursArr.push({ id_match: matchId, id_joueur: userId, buts });\n        }\n        if (temps > 0) {\n          tempsArr.push({ id_match: matchId, id_joueur: userId, temps });\n        }\n        if (passes > 0) {\n          passesArr.push({ id_match: matchId, id_joueur: userId, passes });\n        }\n      });\n\n      setButeurs(buteursArr);\n      setTempsDeJeu(tempsArr);\n      setPassesD(passesArr);\n\n      return { buteursArr, tempsArr, passesArr };\n    } catch (error) {\n      console.error('❌ Erreur chargement stats:', error);\n      return { buteursArr: [], tempsArr: [], passesArr: [] };\n    }\n  };\n\n  const loadEvaluations = async () => {\n    try {\n      const evalsSnap = await getDocs(collection(db, 'evaluations'));\n      const evalsData = evalsSnap.docs.map(d => {\n        const data = d.data();\n        return {\n          id_joueur: String(data.id_joueur), // Convertir en string\n          id_coach: String(data.id_coach), // Convertir en string\n          entrainements: parseFloat(String(data.entrainements || '0').replace(',', '.')) || 0,\n          coaching: parseFloat(String(data.coaching || '0').replace(',', '.')) || 0,\n          relation: parseFloat(String(data.relation || '0').replace(',', '.')) || 0,\n          note_globale: parseFloat(String(data.note_globale || '0').replace(',', '.')) || 0\n        };\n      });\n      setEvaluationsCoach(evalsData);\n      return evalsData;\n    } catch (error) {\n      console.error('❌ Erreur chargement évaluations:', error);\n      return [];\n    }\n  };\n\n  // ============= WRITE FUNCTIONS =============\n\n  const saveMatchs = async (matchsData) => {\n    if (!user || user.role !== 'coach') return;\n\n    try {\n      const batch = writeBatch(db);\n\n      for (const match of matchsData) {\n        const matchRef = doc(db, 'matchs', match.id.toString());\n        batch.set(matchRef, {\n          id: match.id,\n          date: match.date,\n          adversaire: match.adversaire,\n          domicile: match.domicile,\n          statut: match.statut,\n          scoreEquipe: match.scoreEquipe || null,\n          scoreAdversaire: match.scoreAdversaire || null,\n          updatedAt: new Date().toISOString()\n        });\n      }\n\n      await batch.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde matchs:', error);\n      throw error;\n    }\n  };\n\n  const saveConvocations = async (convocsData) => {\n    if (!user || user.role !== 'coach') return;\n    if (!convocsData || convocsData.length === 0) return; // Skip si vide\n\n    try {\n      // Filtrer les convocations valides (pas de undefined)\n      const validConvocs = convocsData.filter(c =>\n        c.id_match !== undefined &&\n        c.id_joueur !== undefined\n      );\n\n      if (validConvocs.length === 0) return; // Skip si aucune valide\n\n      // Supprimer toutes les convocations existantes\n      const existingSnap = await getDocs(collection(db, 'convocations'));\n      const batch1 = writeBatch(db);\n      existingSnap.docs.forEach(d => {\n        batch1.delete(d.ref);\n      });\n      await batch1.commit();\n\n      // Créer les nouvelles convocations\n      const batch2 = writeBatch(db);\n      validConvocs.forEach((convoc) => {\n        const convocRef = doc(db, 'convocations', `${convoc.id_match}_${convoc.id_joueur}`);\n        batch2.set(convocRef, {\n          id_match: convoc.id_match,\n          id_joueur: convoc.id_joueur,\n          convoque: convoc.convoque,\n          statut: convoc.statut,\n          updatedAt: new Date().toISOString()\n        });\n      });\n\n      await batch2.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde convocations:', error);\n      throw error;\n    }\n  };\n\n  const saveNotes = async (notesData) => {\n    if (!user || user.role !== 'coach') return;\n    if (!notesData || notesData.length === 0) return; // Skip si vide\n\n    try {\n      // Filtrer les notes valides (pas de undefined)\n      const validNotes = notesData.filter(n =>\n        n.id_match !== undefined &&\n        n.id_joueur !== undefined\n      );\n\n      if (validNotes.length === 0) return; // Skip si aucune valide\n\n      // Supprimer les notes existantes\n      const existingSnap = await getDocs(collection(db, 'notes'));\n      const batch1 = writeBatch(db);\n      existingSnap.docs.forEach(d => {\n        batch1.delete(d.ref);\n      });\n      await batch1.commit();\n\n      // Créer les nouvelles notes\n      const batch2 = writeBatch(db);\n      validNotes.forEach(note => {\n        const noteRef = doc(db, 'notes', `${note.id_match}_${note.id_joueur}`);\n        batch2.set(noteRef, {\n          id_match: note.id_match,\n          id_joueur: note.id_joueur,\n          note: note.note,\n          updatedAt: new Date().toISOString()\n        });\n      });\n\n      await batch2.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde notes:', error);\n      throw error;\n    }\n  };\n\n  const saveStats = async (buteursData, tempsData, passesData) => {\n    if (!user || user.role !== 'coach') return;\n\n    // Skip si tous les tableaux sont vides\n    if ((!buteursData || buteursData.length === 0) &&\n        (!tempsData || tempsData.length === 0) &&\n        (!passesData || passesData.length === 0)) {\n      return;\n    }\n\n    try {\n      // Supprimer les stats existantes\n      const existingSnap = await getDocs(collection(db, 'stats'));\n      const batch1 = writeBatch(db);\n      existingSnap.docs.forEach(d => {\n        batch1.delete(d.ref);\n      });\n      await batch1.commit();\n\n      // Créer un map pour regrouper les stats par match + joueur\n      const statsMap = new Map();\n\n      // Filtrer et ajouter les buteurs valides\n      (buteursData || []).filter(b => b.id_match !== undefined && b.id_joueur !== undefined).forEach(b => {\n        const key = `${b.id_match}_${b.id_joueur}`;\n        if (!statsMap.has(key)) {\n          statsMap.set(key, { id_match: b.id_match, id_joueur: b.id_joueur, buts: 0, temps: 0, passes: 0 });\n        }\n        statsMap.get(key).buts = b.buts;\n      });\n\n      // Filtrer et ajouter les temps de jeu valides\n      (tempsData || []).filter(t => t.id_match !== undefined && t.id_joueur !== undefined).forEach(t => {\n        const key = `${t.id_match}_${t.id_joueur}`;\n        if (!statsMap.has(key)) {\n          statsMap.set(key, { id_match: t.id_match, id_joueur: t.id_joueur, buts: 0, temps: 0, passes: 0 });\n        }\n        statsMap.get(key).temps = t.temps;\n      });\n\n      // Filtrer et ajouter les passes valides\n      (passesData || []).filter(p => p.id_match !== undefined && p.id_joueur !== undefined).forEach(p => {\n        const key = `${p.id_match}_${p.id_joueur}`;\n        if (!statsMap.has(key)) {\n          statsMap.set(key, { id_match: p.id_match, id_joueur: p.id_joueur, buts: 0, temps: 0, passes: 0 });\n        }\n        statsMap.get(key).passes = p.passes;\n      });\n\n      // Skip si aucune stat valide\n      if (statsMap.size === 0) return;\n\n      // Sauvegarder toutes les stats\n      const batch2 = writeBatch(db);\n      statsMap.forEach((stat, key) => {\n        const statRef = doc(db, 'stats', key);\n        batch2.set(statRef, {\n          id_match: stat.id_match,\n          id_joueur: stat.id_joueur,\n          buts: stat.buts,\n          temps: stat.temps,\n          passes: stat.passes,\n          updatedAt: new Date().toISOString()\n        });\n      });\n\n      await batch2.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde stats:', error);\n      throw error;\n    }\n  };\n\n  const saveEvaluations = async (evalsData) => {\n    try {\n      // Supprimer les évaluations existantes\n      const existingSnap = await getDocs(collection(db, 'evaluations'));\n      const batch1 = writeBatch(db);\n      existingSnap.docs.forEach(d => {\n        batch1.delete(d.ref);\n      });\n      await batch1.commit();\n\n      // Créer les nouvelles évaluations\n      const batch2 = writeBatch(db);\n      evalsData.forEach(evaluation => {\n        const evalRef = doc(db, 'evaluations', `${evaluation.id_joueur}_${evaluation.id_coach}`);\n        batch2.set(evalRef, {\n          id_joueur: evaluation.id_joueur,\n          id_coach: evaluation.id_coach,\n          entrainements: evaluation.entrainements || 0,\n          coaching: evaluation.coaching || 0,\n          relation: evaluation.relation || 0,\n          note_globale: evaluation.note_globale || 0,\n          updatedAt: new Date().toISOString()\n        });\n      });\n\n      await batch2.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde évaluations:', error);\n      throw error;\n    }\n  };\n\n  // ============= INITIAL LOAD =============\n\n  useEffect(() => {\n    if (!user || hasInitialized.current) return;\n\n    const loadData = async () => {\n      try {\n        setLoading(true);\n        await Promise.all([\n          loadJoueurs(),\n          loadMatchs(),\n          loadConvocations(),\n          loadNotes(),\n          loadStats(),\n          loadEvaluations()\n        ]);\n        hasInitialized.current = true;\n        setLoading(false);\n      } catch (error) {\n        console.error('❌ Erreur chargement Firestore:', error);\n        setLoading(false);\n      }\n    };\n\n    loadData();\n  }, [user]);\n\n  // ============= AUTO-SAVE EFFECTS =============\n\n  // Auto-save matchs (coach only)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || user.role !== 'coach' || matchs.length === 0) return;\n    saveMatchs(matchs).catch(err => console.error('Auto-save matchs failed:', err));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [matchs, user]);\n\n  // Auto-save convocations (coach only)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || user.role !== 'coach' || convocations.length === 0) return;\n    saveConvocations(convocations).catch(err => console.error('Auto-save convocations failed:', err));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [convocations, user]);\n\n  // Auto-save notes (coach only)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || user.role !== 'coach' || notes.length === 0) return;\n    saveNotes(notes).catch(err => console.error('Auto-save notes failed:', err));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [notes, user]);\n\n  // Auto-save stats (coach only)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || user.role !== 'coach') return;\n    if (buteurs.length === 0 && tempsDeJeu.length === 0 && passesD.length === 0) return;\n    saveStats(buteurs, tempsDeJeu, passesD).catch(err => console.error('Auto-save stats failed:', err));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [buteurs, tempsDeJeu, passesD, user]);\n\n  // Auto-save evaluations (tous les joueurs)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || evaluationsCoach.length === 0) return;\n    saveEvaluations(evaluationsCoach).catch(err => console.error('Auto-save evaluations failed:', err));\n  }, [evaluationsCoach, user]);\n\n  return {\n    joueurs,\n    matchs,\n    setMatchs,\n    convocations,\n    setConvocations,\n    notes,\n    setNotes,\n    buteurs,\n    setButeurs,\n    tempsDeJeu,\n    setTempsDeJeu,\n    passesD,\n    setPassesD,\n    evaluationsCoach,\n    setEvaluationsCoach,\n    loading,\n    loadConvocations,\n    loadMatchs,\n    loadNotes,\n    loadStats,\n    loadEvaluations\n  };\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}