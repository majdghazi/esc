{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useRef } from 'react';\nimport { collection, getDocs, doc, writeBatch } from 'firebase/firestore';\nimport { db } from '../config/firebase';\nexport const useFirestore = user => {\n  _s();\n  const [joueurs, setJoueurs] = useState([]);\n  const [matchs, setMatchs] = useState([]);\n  const [convocations, setConvocations] = useState([]);\n  const [notes, setNotes] = useState([]);\n  const [buteurs, setButeurs] = useState([]);\n  const [tempsDeJeu, setTempsDeJeu] = useState([]);\n  const [passesD, setPassesD] = useState([]);\n  const [evaluationsCoach, setEvaluationsCoach] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const hasInitialized = useRef(false);\n\n  // ============= READ FUNCTIONS =============\n\n  const loadJoueurs = async () => {\n    try {\n      const usersSnap = await getDocs(collection(db, 'users'));\n      const joueursData = usersSnap.docs.map(d => ({\n        id: d.data().id || d.id,\n        nom: d.data().nom,\n        username: d.data().username,\n        role: d.data().role\n      }));\n      setJoueurs(joueursData);\n      return joueursData;\n    } catch (error) {\n      console.error('❌ Erreur chargement joueurs:', error);\n      return [];\n    }\n  };\n  const loadMatchs = async () => {\n    try {\n      const matchsSnap = await getDocs(collection(db, 'matchs'));\n      const matchsData = matchsSnap.docs.map(d => {\n        const data = d.data();\n        return {\n          id: data.id || d.id,\n          date: data.date || '',\n          adversaire: data.adversaire || '',\n          domicile: data.domicile || 'false',\n          statut: data.statut || 'avenir',\n          scoreEquipe: data.scoreEquipe || null,\n          scoreAdversaire: data.scoreAdversaire || null\n        };\n      });\n      matchsData.sort((a, b) => {\n        const dateA = a.date.split('/').reverse().join('-');\n        const dateB = b.date.split('/').reverse().join('-');\n        return new Date(dateA) - new Date(dateB);\n      });\n      setMatchs(matchsData);\n      return matchsData;\n    } catch (error) {\n      console.error('❌ Erreur chargement matchs:', error);\n      return [];\n    }\n  };\n  const loadConvocations = async () => {\n    try {\n      const convocsSnap = await getDocs(collection(db, 'convocations'));\n      const convocsData = convocsSnap.docs.map(d => ({\n        id_match: d.data().id_match,\n        id_joueur: d.data().id_joueur,\n        convoque: d.data().convoque,\n        statut: d.data().statut\n      }));\n      setConvocations(convocsData);\n      return convocsData;\n    } catch (error) {\n      console.error('❌ Erreur chargement convocations:', error);\n      return [];\n    }\n  };\n  const loadNotes = async () => {\n    try {\n      const notesSnap = await getDocs(collection(db, 'notes'));\n      const notesData = notesSnap.docs.map(d => ({\n        id_match: d.data().id_match,\n        id_joueur: d.data().id_joueur,\n        note: parseFloat(d.data().note) || 0 // Convertir en nombre\n      }));\n      setNotes(notesData);\n      return notesData;\n    } catch (error) {\n      console.error('❌ Erreur chargement notes:', error);\n      return [];\n    }\n  };\n  const loadStats = async () => {\n    try {\n      const statsSnap = await getDocs(collection(db, 'stats'));\n      const buteursArr = [];\n      const tempsArr = [];\n      const passesArr = [];\n      statsSnap.docs.forEach(d => {\n        const data = d.data();\n        const matchId = data.id_match;\n        const userId = data.id_joueur;\n        if (data.buts > 0) {\n          buteursArr.push({\n            id_match: matchId,\n            id_joueur: userId,\n            buts: data.buts\n          });\n        }\n        if (data.temps > 0) {\n          tempsArr.push({\n            id_match: matchId,\n            id_joueur: userId,\n            temps: data.temps\n          });\n        }\n        if (data.passes > 0) {\n          passesArr.push({\n            id_match: matchId,\n            id_joueur: userId,\n            passes: data.passes\n          });\n        }\n      });\n      setButeurs(buteursArr);\n      setTempsDeJeu(tempsArr);\n      setPassesD(passesArr);\n      return {\n        buteursArr,\n        tempsArr,\n        passesArr\n      };\n    } catch (error) {\n      console.error('❌ Erreur chargement stats:', error);\n      return {\n        buteursArr: [],\n        tempsArr: [],\n        passesArr: []\n      };\n    }\n  };\n  const loadEvaluations = async () => {\n    try {\n      const evalsSnap = await getDocs(collection(db, 'evaluations'));\n      const evalsData = evalsSnap.docs.map(d => ({\n        id_joueur: d.data().id_joueur,\n        evaluateur: d.data().evaluateur,\n        technicite: d.data().technicite || 0,\n        vision: d.data().vision || 0,\n        collectif: d.data().collectif || 0,\n        mental: d.data().mental || 0\n      }));\n      setEvaluationsCoach(evalsData);\n      return evalsData;\n    } catch (error) {\n      console.error('❌ Erreur chargement évaluations:', error);\n      return [];\n    }\n  };\n\n  // ============= WRITE FUNCTIONS =============\n\n  const saveMatchs = async matchsData => {\n    if (!user || user.role !== 'coach') return;\n    try {\n      const batch = writeBatch(db);\n      for (const match of matchsData) {\n        const matchRef = doc(db, 'matchs', match.id.toString());\n        batch.set(matchRef, {\n          id: match.id,\n          date: match.date,\n          adversaire: match.adversaire,\n          domicile: match.domicile,\n          statut: match.statut,\n          scoreEquipe: match.scoreEquipe || null,\n          scoreAdversaire: match.scoreAdversaire || null,\n          updatedAt: new Date().toISOString()\n        });\n      }\n      await batch.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde matchs:', error);\n      throw error;\n    }\n  };\n  const saveConvocations = async convocsData => {\n    if (!user || user.role !== 'coach') return;\n    if (!convocsData || convocsData.length === 0) return; // Skip si vide\n\n    try {\n      // Filtrer les convocations valides (pas de undefined)\n      const validConvocs = convocsData.filter(c => c.id_match !== undefined && c.id_joueur !== undefined);\n      if (validConvocs.length === 0) return; // Skip si aucune valide\n\n      // Supprimer toutes les convocations existantes\n      const existingSnap = await getDocs(collection(db, 'convocations'));\n      const batch1 = writeBatch(db);\n      existingSnap.docs.forEach(d => {\n        batch1.delete(d.ref);\n      });\n      await batch1.commit();\n\n      // Créer les nouvelles convocations\n      const batch2 = writeBatch(db);\n      validConvocs.forEach(convoc => {\n        const convocRef = doc(db, 'convocations', `${convoc.id_match}_${convoc.id_joueur}`);\n        batch2.set(convocRef, {\n          id_match: convoc.id_match,\n          id_joueur: convoc.id_joueur,\n          convoque: convoc.convoque,\n          statut: convoc.statut,\n          updatedAt: new Date().toISOString()\n        });\n      });\n      await batch2.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde convocations:', error);\n      throw error;\n    }\n  };\n  const saveNotes = async notesData => {\n    if (!user || user.role !== 'coach') return;\n    if (!notesData || notesData.length === 0) return; // Skip si vide\n\n    try {\n      // Filtrer les notes valides (pas de undefined)\n      const validNotes = notesData.filter(n => n.id_match !== undefined && n.id_joueur !== undefined);\n      if (validNotes.length === 0) return; // Skip si aucune valide\n\n      // Supprimer les notes existantes\n      const existingSnap = await getDocs(collection(db, 'notes'));\n      const batch1 = writeBatch(db);\n      existingSnap.docs.forEach(d => {\n        batch1.delete(d.ref);\n      });\n      await batch1.commit();\n\n      // Créer les nouvelles notes\n      const batch2 = writeBatch(db);\n      validNotes.forEach(note => {\n        const noteRef = doc(db, 'notes', `${note.id_match}_${note.id_joueur}`);\n        batch2.set(noteRef, {\n          id_match: note.id_match,\n          id_joueur: note.id_joueur,\n          note: note.note,\n          updatedAt: new Date().toISOString()\n        });\n      });\n      await batch2.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde notes:', error);\n      throw error;\n    }\n  };\n  const saveStats = async (buteursData, tempsData, passesData) => {\n    if (!user || user.role !== 'coach') return;\n\n    // Skip si tous les tableaux sont vides\n    if ((!buteursData || buteursData.length === 0) && (!tempsData || tempsData.length === 0) && (!passesData || passesData.length === 0)) {\n      return;\n    }\n    try {\n      // Supprimer les stats existantes\n      const existingSnap = await getDocs(collection(db, 'stats'));\n      const batch1 = writeBatch(db);\n      existingSnap.docs.forEach(d => {\n        batch1.delete(d.ref);\n      });\n      await batch1.commit();\n\n      // Créer un map pour regrouper les stats par match + joueur\n      const statsMap = new Map();\n\n      // Filtrer et ajouter les buteurs valides\n      (buteursData || []).filter(b => b.id_match !== undefined && b.id_joueur !== undefined).forEach(b => {\n        const key = `${b.id_match}_${b.id_joueur}`;\n        if (!statsMap.has(key)) {\n          statsMap.set(key, {\n            id_match: b.id_match,\n            id_joueur: b.id_joueur,\n            buts: 0,\n            temps: 0,\n            passes: 0\n          });\n        }\n        statsMap.get(key).buts = b.buts;\n      });\n\n      // Filtrer et ajouter les temps de jeu valides\n      (tempsData || []).filter(t => t.id_match !== undefined && t.id_joueur !== undefined).forEach(t => {\n        const key = `${t.id_match}_${t.id_joueur}`;\n        if (!statsMap.has(key)) {\n          statsMap.set(key, {\n            id_match: t.id_match,\n            id_joueur: t.id_joueur,\n            buts: 0,\n            temps: 0,\n            passes: 0\n          });\n        }\n        statsMap.get(key).temps = t.temps;\n      });\n\n      // Filtrer et ajouter les passes valides\n      (passesData || []).filter(p => p.id_match !== undefined && p.id_joueur !== undefined).forEach(p => {\n        const key = `${p.id_match}_${p.id_joueur}`;\n        if (!statsMap.has(key)) {\n          statsMap.set(key, {\n            id_match: p.id_match,\n            id_joueur: p.id_joueur,\n            buts: 0,\n            temps: 0,\n            passes: 0\n          });\n        }\n        statsMap.get(key).passes = p.passes;\n      });\n\n      // Skip si aucune stat valide\n      if (statsMap.size === 0) return;\n\n      // Sauvegarder toutes les stats\n      const batch2 = writeBatch(db);\n      statsMap.forEach((stat, key) => {\n        const statRef = doc(db, 'stats', key);\n        batch2.set(statRef, {\n          id_match: stat.id_match,\n          id_joueur: stat.id_joueur,\n          buts: stat.buts,\n          temps: stat.temps,\n          passes: stat.passes,\n          updatedAt: new Date().toISOString()\n        });\n      });\n      await batch2.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde stats:', error);\n      throw error;\n    }\n  };\n  const saveEvaluations = async evalsData => {\n    try {\n      // Supprimer les évaluations existantes\n      const existingSnap = await getDocs(collection(db, 'evaluations'));\n      const batch1 = writeBatch(db);\n      existingSnap.docs.forEach(d => {\n        batch1.delete(d.ref);\n      });\n      await batch1.commit();\n\n      // Créer les nouvelles évaluations\n      const batch2 = writeBatch(db);\n      evalsData.forEach(evaluation => {\n        const evalRef = doc(db, 'evaluations', `${evaluation.id_joueur}_${evaluation.evaluateur}`);\n        batch2.set(evalRef, {\n          id_joueur: evaluation.id_joueur,\n          evaluateur: evaluation.evaluateur,\n          technicite: evaluation.technicite || 0,\n          vision: evaluation.vision || 0,\n          collectif: evaluation.collectif || 0,\n          mental: evaluation.mental || 0,\n          updatedAt: new Date().toISOString()\n        });\n      });\n      await batch2.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde évaluations:', error);\n      throw error;\n    }\n  };\n\n  // ============= INITIAL LOAD =============\n\n  useEffect(() => {\n    if (!user || hasInitialized.current) return;\n    const loadData = async () => {\n      try {\n        setLoading(true);\n        await Promise.all([loadJoueurs(), loadMatchs(), loadConvocations(), loadNotes(), loadStats(), loadEvaluations()]);\n        hasInitialized.current = true;\n        setLoading(false);\n      } catch (error) {\n        console.error('❌ Erreur chargement Firestore:', error);\n        setLoading(false);\n      }\n    };\n    loadData();\n  }, [user]);\n\n  // ============= AUTO-SAVE EFFECTS =============\n\n  // Auto-save matchs (coach only)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || user.role !== 'coach' || matchs.length === 0) return;\n    saveMatchs(matchs).catch(err => console.error('Auto-save matchs failed:', err));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [matchs, user]);\n\n  // Auto-save convocations (coach only)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || user.role !== 'coach' || convocations.length === 0) return;\n    saveConvocations(convocations).catch(err => console.error('Auto-save convocations failed:', err));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [convocations, user]);\n\n  // Auto-save notes (coach only)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || user.role !== 'coach' || notes.length === 0) return;\n    saveNotes(notes).catch(err => console.error('Auto-save notes failed:', err));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [notes, user]);\n\n  // Auto-save stats (coach only)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || user.role !== 'coach') return;\n    if (buteurs.length === 0 && tempsDeJeu.length === 0 && passesD.length === 0) return;\n    saveStats(buteurs, tempsDeJeu, passesD).catch(err => console.error('Auto-save stats failed:', err));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [buteurs, tempsDeJeu, passesD, user]);\n\n  // Auto-save evaluations (tous les joueurs)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || evaluationsCoach.length === 0) return;\n    saveEvaluations(evaluationsCoach).catch(err => console.error('Auto-save evaluations failed:', err));\n  }, [evaluationsCoach, user]);\n  return {\n    joueurs,\n    matchs,\n    setMatchs,\n    convocations,\n    setConvocations,\n    notes,\n    setNotes,\n    buteurs,\n    setButeurs,\n    tempsDeJeu,\n    setTempsDeJeu,\n    passesD,\n    setPassesD,\n    evaluationsCoach,\n    setEvaluationsCoach,\n    loading,\n    loadConvocations,\n    loadMatchs,\n    loadNotes,\n    loadStats,\n    loadEvaluations\n  };\n};\n_s(useFirestore, \"hWgc4aDZEO4LXcghf0pMXbvjsHY=\");","map":{"version":3,"names":["useState","useEffect","useRef","collection","getDocs","doc","writeBatch","db","useFirestore","user","_s","joueurs","setJoueurs","matchs","setMatchs","convocations","setConvocations","notes","setNotes","buteurs","setButeurs","tempsDeJeu","setTempsDeJeu","passesD","setPassesD","evaluationsCoach","setEvaluationsCoach","loading","setLoading","hasInitialized","loadJoueurs","usersSnap","joueursData","docs","map","d","id","data","nom","username","role","error","console","loadMatchs","matchsSnap","matchsData","date","adversaire","domicile","statut","scoreEquipe","scoreAdversaire","sort","a","b","dateA","split","reverse","join","dateB","Date","loadConvocations","convocsSnap","convocsData","id_match","id_joueur","convoque","loadNotes","notesSnap","notesData","note","parseFloat","loadStats","statsSnap","buteursArr","tempsArr","passesArr","forEach","matchId","userId","buts","push","temps","passes","loadEvaluations","evalsSnap","evalsData","evaluateur","technicite","vision","collectif","mental","saveMatchs","batch","match","matchRef","toString","set","updatedAt","toISOString","commit","saveConvocations","length","validConvocs","filter","c","undefined","existingSnap","batch1","delete","ref","batch2","convoc","convocRef","saveNotes","validNotes","n","noteRef","saveStats","buteursData","tempsData","passesData","statsMap","Map","key","has","get","t","p","size","stat","statRef","saveEvaluations","evaluation","evalRef","current","loadData","Promise","all","catch","err"],"sources":["/Users/hichamghazi/Desktop/esc-cappelle/src/hooks/useFirestore.js"],"sourcesContent":["import { useState, useEffect, useRef } from 'react';\nimport {\n  collection,\n  getDocs,\n  doc,\n  writeBatch\n} from 'firebase/firestore';\nimport { db } from '../config/firebase';\n\nexport const useFirestore = (user) => {\n  const [joueurs, setJoueurs] = useState([]);\n  const [matchs, setMatchs] = useState([]);\n  const [convocations, setConvocations] = useState([]);\n  const [notes, setNotes] = useState([]);\n  const [buteurs, setButeurs] = useState([]);\n  const [tempsDeJeu, setTempsDeJeu] = useState([]);\n  const [passesD, setPassesD] = useState([]);\n  const [evaluationsCoach, setEvaluationsCoach] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  const hasInitialized = useRef(false);\n\n  // ============= READ FUNCTIONS =============\n\n  const loadJoueurs = async () => {\n    try {\n      const usersSnap = await getDocs(collection(db, 'users'));\n      const joueursData = usersSnap.docs.map(d => ({\n        id: d.data().id || d.id,\n        nom: d.data().nom,\n        username: d.data().username,\n        role: d.data().role\n      }));\n      setJoueurs(joueursData);\n      return joueursData;\n    } catch (error) {\n      console.error('❌ Erreur chargement joueurs:', error);\n      return [];\n    }\n  };\n\n  const loadMatchs = async () => {\n    try {\n      const matchsSnap = await getDocs(collection(db, 'matchs'));\n      const matchsData = matchsSnap.docs.map(d => {\n        const data = d.data();\n        return {\n          id: data.id || d.id,\n          date: data.date || '',\n          adversaire: data.adversaire || '',\n          domicile: data.domicile || 'false',\n          statut: data.statut || 'avenir',\n          scoreEquipe: data.scoreEquipe || null,\n          scoreAdversaire: data.scoreAdversaire || null\n        };\n      });\n      matchsData.sort((a, b) => {\n        const dateA = a.date.split('/').reverse().join('-');\n        const dateB = b.date.split('/').reverse().join('-');\n        return new Date(dateA) - new Date(dateB);\n      });\n      setMatchs(matchsData);\n      return matchsData;\n    } catch (error) {\n      console.error('❌ Erreur chargement matchs:', error);\n      return [];\n    }\n  };\n\n  const loadConvocations = async () => {\n    try {\n      const convocsSnap = await getDocs(collection(db, 'convocations'));\n      const convocsData = convocsSnap.docs.map(d => ({\n        id_match: d.data().id_match,\n        id_joueur: d.data().id_joueur,\n        convoque: d.data().convoque,\n        statut: d.data().statut\n      }));\n      setConvocations(convocsData);\n      return convocsData;\n    } catch (error) {\n      console.error('❌ Erreur chargement convocations:', error);\n      return [];\n    }\n  };\n\n  const loadNotes = async () => {\n    try {\n      const notesSnap = await getDocs(collection(db, 'notes'));\n      const notesData = notesSnap.docs.map(d => ({\n        id_match: d.data().id_match,\n        id_joueur: d.data().id_joueur,\n        note: parseFloat(d.data().note) || 0 // Convertir en nombre\n      }));\n      setNotes(notesData);\n      return notesData;\n    } catch (error) {\n      console.error('❌ Erreur chargement notes:', error);\n      return [];\n    }\n  };\n\n  const loadStats = async () => {\n    try {\n      const statsSnap = await getDocs(collection(db, 'stats'));\n      const buteursArr = [];\n      const tempsArr = [];\n      const passesArr = [];\n\n      statsSnap.docs.forEach(d => {\n        const data = d.data();\n        const matchId = data.id_match;\n        const userId = data.id_joueur;\n\n        if (data.buts > 0) {\n          buteursArr.push({ id_match: matchId, id_joueur: userId, buts: data.buts });\n        }\n        if (data.temps > 0) {\n          tempsArr.push({ id_match: matchId, id_joueur: userId, temps: data.temps });\n        }\n        if (data.passes > 0) {\n          passesArr.push({ id_match: matchId, id_joueur: userId, passes: data.passes });\n        }\n      });\n\n      setButeurs(buteursArr);\n      setTempsDeJeu(tempsArr);\n      setPassesD(passesArr);\n\n      return { buteursArr, tempsArr, passesArr };\n    } catch (error) {\n      console.error('❌ Erreur chargement stats:', error);\n      return { buteursArr: [], tempsArr: [], passesArr: [] };\n    }\n  };\n\n  const loadEvaluations = async () => {\n    try {\n      const evalsSnap = await getDocs(collection(db, 'evaluations'));\n      const evalsData = evalsSnap.docs.map(d => ({\n        id_joueur: d.data().id_joueur,\n        evaluateur: d.data().evaluateur,\n        technicite: d.data().technicite || 0,\n        vision: d.data().vision || 0,\n        collectif: d.data().collectif || 0,\n        mental: d.data().mental || 0\n      }));\n      setEvaluationsCoach(evalsData);\n      return evalsData;\n    } catch (error) {\n      console.error('❌ Erreur chargement évaluations:', error);\n      return [];\n    }\n  };\n\n  // ============= WRITE FUNCTIONS =============\n\n  const saveMatchs = async (matchsData) => {\n    if (!user || user.role !== 'coach') return;\n\n    try {\n      const batch = writeBatch(db);\n\n      for (const match of matchsData) {\n        const matchRef = doc(db, 'matchs', match.id.toString());\n        batch.set(matchRef, {\n          id: match.id,\n          date: match.date,\n          adversaire: match.adversaire,\n          domicile: match.domicile,\n          statut: match.statut,\n          scoreEquipe: match.scoreEquipe || null,\n          scoreAdversaire: match.scoreAdversaire || null,\n          updatedAt: new Date().toISOString()\n        });\n      }\n\n      await batch.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde matchs:', error);\n      throw error;\n    }\n  };\n\n  const saveConvocations = async (convocsData) => {\n    if (!user || user.role !== 'coach') return;\n    if (!convocsData || convocsData.length === 0) return; // Skip si vide\n\n    try {\n      // Filtrer les convocations valides (pas de undefined)\n      const validConvocs = convocsData.filter(c =>\n        c.id_match !== undefined &&\n        c.id_joueur !== undefined\n      );\n\n      if (validConvocs.length === 0) return; // Skip si aucune valide\n\n      // Supprimer toutes les convocations existantes\n      const existingSnap = await getDocs(collection(db, 'convocations'));\n      const batch1 = writeBatch(db);\n      existingSnap.docs.forEach(d => {\n        batch1.delete(d.ref);\n      });\n      await batch1.commit();\n\n      // Créer les nouvelles convocations\n      const batch2 = writeBatch(db);\n      validConvocs.forEach((convoc) => {\n        const convocRef = doc(db, 'convocations', `${convoc.id_match}_${convoc.id_joueur}`);\n        batch2.set(convocRef, {\n          id_match: convoc.id_match,\n          id_joueur: convoc.id_joueur,\n          convoque: convoc.convoque,\n          statut: convoc.statut,\n          updatedAt: new Date().toISOString()\n        });\n      });\n\n      await batch2.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde convocations:', error);\n      throw error;\n    }\n  };\n\n  const saveNotes = async (notesData) => {\n    if (!user || user.role !== 'coach') return;\n    if (!notesData || notesData.length === 0) return; // Skip si vide\n\n    try {\n      // Filtrer les notes valides (pas de undefined)\n      const validNotes = notesData.filter(n =>\n        n.id_match !== undefined &&\n        n.id_joueur !== undefined\n      );\n\n      if (validNotes.length === 0) return; // Skip si aucune valide\n\n      // Supprimer les notes existantes\n      const existingSnap = await getDocs(collection(db, 'notes'));\n      const batch1 = writeBatch(db);\n      existingSnap.docs.forEach(d => {\n        batch1.delete(d.ref);\n      });\n      await batch1.commit();\n\n      // Créer les nouvelles notes\n      const batch2 = writeBatch(db);\n      validNotes.forEach(note => {\n        const noteRef = doc(db, 'notes', `${note.id_match}_${note.id_joueur}`);\n        batch2.set(noteRef, {\n          id_match: note.id_match,\n          id_joueur: note.id_joueur,\n          note: note.note,\n          updatedAt: new Date().toISOString()\n        });\n      });\n\n      await batch2.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde notes:', error);\n      throw error;\n    }\n  };\n\n  const saveStats = async (buteursData, tempsData, passesData) => {\n    if (!user || user.role !== 'coach') return;\n\n    // Skip si tous les tableaux sont vides\n    if ((!buteursData || buteursData.length === 0) &&\n        (!tempsData || tempsData.length === 0) &&\n        (!passesData || passesData.length === 0)) {\n      return;\n    }\n\n    try {\n      // Supprimer les stats existantes\n      const existingSnap = await getDocs(collection(db, 'stats'));\n      const batch1 = writeBatch(db);\n      existingSnap.docs.forEach(d => {\n        batch1.delete(d.ref);\n      });\n      await batch1.commit();\n\n      // Créer un map pour regrouper les stats par match + joueur\n      const statsMap = new Map();\n\n      // Filtrer et ajouter les buteurs valides\n      (buteursData || []).filter(b => b.id_match !== undefined && b.id_joueur !== undefined).forEach(b => {\n        const key = `${b.id_match}_${b.id_joueur}`;\n        if (!statsMap.has(key)) {\n          statsMap.set(key, { id_match: b.id_match, id_joueur: b.id_joueur, buts: 0, temps: 0, passes: 0 });\n        }\n        statsMap.get(key).buts = b.buts;\n      });\n\n      // Filtrer et ajouter les temps de jeu valides\n      (tempsData || []).filter(t => t.id_match !== undefined && t.id_joueur !== undefined).forEach(t => {\n        const key = `${t.id_match}_${t.id_joueur}`;\n        if (!statsMap.has(key)) {\n          statsMap.set(key, { id_match: t.id_match, id_joueur: t.id_joueur, buts: 0, temps: 0, passes: 0 });\n        }\n        statsMap.get(key).temps = t.temps;\n      });\n\n      // Filtrer et ajouter les passes valides\n      (passesData || []).filter(p => p.id_match !== undefined && p.id_joueur !== undefined).forEach(p => {\n        const key = `${p.id_match}_${p.id_joueur}`;\n        if (!statsMap.has(key)) {\n          statsMap.set(key, { id_match: p.id_match, id_joueur: p.id_joueur, buts: 0, temps: 0, passes: 0 });\n        }\n        statsMap.get(key).passes = p.passes;\n      });\n\n      // Skip si aucune stat valide\n      if (statsMap.size === 0) return;\n\n      // Sauvegarder toutes les stats\n      const batch2 = writeBatch(db);\n      statsMap.forEach((stat, key) => {\n        const statRef = doc(db, 'stats', key);\n        batch2.set(statRef, {\n          id_match: stat.id_match,\n          id_joueur: stat.id_joueur,\n          buts: stat.buts,\n          temps: stat.temps,\n          passes: stat.passes,\n          updatedAt: new Date().toISOString()\n        });\n      });\n\n      await batch2.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde stats:', error);\n      throw error;\n    }\n  };\n\n  const saveEvaluations = async (evalsData) => {\n    try {\n      // Supprimer les évaluations existantes\n      const existingSnap = await getDocs(collection(db, 'evaluations'));\n      const batch1 = writeBatch(db);\n      existingSnap.docs.forEach(d => {\n        batch1.delete(d.ref);\n      });\n      await batch1.commit();\n\n      // Créer les nouvelles évaluations\n      const batch2 = writeBatch(db);\n      evalsData.forEach(evaluation => {\n        const evalRef = doc(db, 'evaluations', `${evaluation.id_joueur}_${evaluation.evaluateur}`);\n        batch2.set(evalRef, {\n          id_joueur: evaluation.id_joueur,\n          evaluateur: evaluation.evaluateur,\n          technicite: evaluation.technicite || 0,\n          vision: evaluation.vision || 0,\n          collectif: evaluation.collectif || 0,\n          mental: evaluation.mental || 0,\n          updatedAt: new Date().toISOString()\n        });\n      });\n\n      await batch2.commit();\n    } catch (error) {\n      console.error('❌ Erreur sauvegarde évaluations:', error);\n      throw error;\n    }\n  };\n\n  // ============= INITIAL LOAD =============\n\n  useEffect(() => {\n    if (!user || hasInitialized.current) return;\n\n    const loadData = async () => {\n      try {\n        setLoading(true);\n        await Promise.all([\n          loadJoueurs(),\n          loadMatchs(),\n          loadConvocations(),\n          loadNotes(),\n          loadStats(),\n          loadEvaluations()\n        ]);\n        hasInitialized.current = true;\n        setLoading(false);\n      } catch (error) {\n        console.error('❌ Erreur chargement Firestore:', error);\n        setLoading(false);\n      }\n    };\n\n    loadData();\n  }, [user]);\n\n  // ============= AUTO-SAVE EFFECTS =============\n\n  // Auto-save matchs (coach only)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || user.role !== 'coach' || matchs.length === 0) return;\n    saveMatchs(matchs).catch(err => console.error('Auto-save matchs failed:', err));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [matchs, user]);\n\n  // Auto-save convocations (coach only)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || user.role !== 'coach' || convocations.length === 0) return;\n    saveConvocations(convocations).catch(err => console.error('Auto-save convocations failed:', err));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [convocations, user]);\n\n  // Auto-save notes (coach only)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || user.role !== 'coach' || notes.length === 0) return;\n    saveNotes(notes).catch(err => console.error('Auto-save notes failed:', err));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [notes, user]);\n\n  // Auto-save stats (coach only)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || user.role !== 'coach') return;\n    if (buteurs.length === 0 && tempsDeJeu.length === 0 && passesD.length === 0) return;\n    saveStats(buteurs, tempsDeJeu, passesD).catch(err => console.error('Auto-save stats failed:', err));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [buteurs, tempsDeJeu, passesD, user]);\n\n  // Auto-save evaluations (tous les joueurs)\n  useEffect(() => {\n    if (!hasInitialized.current || !user || evaluationsCoach.length === 0) return;\n    saveEvaluations(evaluationsCoach).catch(err => console.error('Auto-save evaluations failed:', err));\n  }, [evaluationsCoach, user]);\n\n  return {\n    joueurs,\n    matchs,\n    setMatchs,\n    convocations,\n    setConvocations,\n    notes,\n    setNotes,\n    buteurs,\n    setButeurs,\n    tempsDeJeu,\n    setTempsDeJeu,\n    passesD,\n    setPassesD,\n    evaluationsCoach,\n    setEvaluationsCoach,\n    loading,\n    loadConvocations,\n    loadMatchs,\n    loadNotes,\n    loadStats,\n    loadEvaluations\n  };\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}