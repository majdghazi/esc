{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState } from 'react';\nimport { doc, updateDoc, deleteDoc, setDoc, getDoc } from 'firebase/firestore';\nimport { db } from '../config/firebase';\nconst useMatchManagement = () => {\n  _s();\n  const [selectedMatch, setSelectedMatch] = useState(null);\n  const [showScoreModal, setShowScoreModal] = useState(false);\n  const [matchToPlay, setMatchToPlay] = useState(null);\n  const [scoreEquipeInput, setScoreEquipeInput] = useState('');\n  const [scoreAdversaireInput, setScoreAdversaireInput] = useState('');\n  const marquerCommeJoue = async (matchId, matchs) => {\n    const match = matchs.find(m => m.id === matchId);\n    if (!match) return;\n    setMatchToPlay(match);\n    setShowScoreModal(true);\n  };\n  const confirmerScoreEtJouer = async (matchs, setMatchs, showNotification) => {\n    if (!matchToPlay) return;\n    const scoreEquipe = parseInt(scoreEquipeInput) || 0;\n    const scoreAdversaire = parseInt(scoreAdversaireInput) || 0;\n    try {\n      // Vérifier si le match existe dans Firestore\n      const matchRef = doc(db, 'matchs', String(matchToPlay.id));\n      const matchDoc = await getDoc(matchRef);\n      if (matchDoc.exists()) {\n        // Mettre à jour\n        await updateDoc(matchRef, {\n          statut: 'joue',\n          score_equipe: scoreEquipe,\n          score_adversaire: scoreAdversaire,\n          updatedAt: new Date()\n        });\n      } else {\n        // Créer le document avec seulement les champs définis\n        const matchData = {\n          id: String(matchToPlay.id),\n          adversaire: matchToPlay.adversaire || '',\n          date: matchToPlay.date || '',\n          statut: 'joue',\n          score_equipe: scoreEquipe,\n          score_adversaire: scoreAdversaire,\n          createdAt: new Date(),\n          updatedAt: new Date()\n        };\n\n        // Ajouter lieu seulement s'il existe\n        if (matchToPlay.lieu) {\n          matchData.lieu = matchToPlay.lieu;\n        }\n        await setDoc(matchRef, matchData);\n      }\n\n      // Mettre à jour local\n      const updatedMatchs = matchs.map(m => m.id === matchToPlay.id ? {\n        ...m,\n        statut: 'joue',\n        score_equipe: scoreEquipe,\n        score_adversaire: scoreAdversaire\n      } : m);\n      setMatchs(updatedMatchs);\n      showNotification('✅ Match marqué comme joué', 'success');\n      setShowScoreModal(false);\n      setMatchToPlay(null);\n      setScoreEquipeInput('');\n      setScoreAdversaireInput('');\n    } catch (error) {\n      console.error('Erreur confirmerScoreEtJouer:', error);\n      showNotification('❌ Erreur lors de la mise à jour du match', 'error');\n    }\n  };\n  const repasserEnAttente = async (matchId, matchs, setMatchs, notes) => {\n    if (!window.confirm('Repasser ce match en attente ? Les notes seront supprimées.')) {\n      return;\n    }\n    try {\n      // Vérifier si le match existe dans Firestore\n      const matchRef = doc(db, 'matchs', String(matchId));\n      const matchDoc = await getDoc(matchRef);\n      if (matchDoc.exists()) {\n        await updateDoc(matchRef, {\n          statut: 'avenir',\n          score_equipe: null,\n          score_adversaire: null,\n          updatedAt: new Date()\n        });\n      }\n\n      // Supprimer les notes associées dans Firestore\n      const notesToDelete = notes.filter(n => n.id_match === matchId);\n      for (const note of notesToDelete) {\n        const noteRef = doc(db, 'notes', `${matchId}_${note.id_joueur}`);\n        const noteDoc = await getDoc(noteRef);\n        if (noteDoc.exists()) {\n          await deleteDoc(noteRef);\n        }\n      }\n\n      // Mettre à jour local\n      const updatedMatchs = matchs.map(m => m.id === matchId ? {\n        ...m,\n        statut: 'avenir',\n        score_equipe: null,\n        score_adversaire: null\n      } : m);\n      setMatchs(updatedMatchs);\n    } catch (error) {\n      console.error('Erreur repasserEnAttente:', error);\n    }\n  };\n  return {\n    selectedMatch,\n    setSelectedMatch,\n    showScoreModal,\n    setShowScoreModal,\n    matchToPlay,\n    scoreEquipeInput,\n    setScoreEquipeInput,\n    scoreAdversaireInput,\n    setScoreAdversaireInput,\n    marquerCommeJoue,\n    confirmerScoreEtJouer,\n    repasserEnAttente\n  };\n};\n_s(useMatchManagement, \"Q533ElhaT7BJBKjOew8PKupqGJQ=\");\nexport default useMatchManagement;","map":{"version":3,"names":["useState","doc","updateDoc","deleteDoc","setDoc","getDoc","db","useMatchManagement","_s","selectedMatch","setSelectedMatch","showScoreModal","setShowScoreModal","matchToPlay","setMatchToPlay","scoreEquipeInput","setScoreEquipeInput","scoreAdversaireInput","setScoreAdversaireInput","marquerCommeJoue","matchId","matchs","match","find","m","id","confirmerScoreEtJouer","setMatchs","showNotification","scoreEquipe","parseInt","scoreAdversaire","matchRef","String","matchDoc","exists","statut","score_equipe","score_adversaire","updatedAt","Date","matchData","adversaire","date","createdAt","lieu","updatedMatchs","map","error","console","repasserEnAttente","notes","window","confirm","notesToDelete","filter","n","id_match","note","noteRef","id_joueur","noteDoc"],"sources":["/Users/hichamghazi/Desktop/esc-cappelle/src/hooks/useMatchManagement.js"],"sourcesContent":["import { useState } from 'react';\nimport { doc, updateDoc, deleteDoc, setDoc, getDoc } from 'firebase/firestore';\nimport { db } from '../config/firebase';\n\nconst useMatchManagement = () => {\n  const [selectedMatch, setSelectedMatch] = useState(null);\n  const [showScoreModal, setShowScoreModal] = useState(false);\n  const [matchToPlay, setMatchToPlay] = useState(null);\n  const [scoreEquipeInput, setScoreEquipeInput] = useState('');\n  const [scoreAdversaireInput, setScoreAdversaireInput] = useState('');\n\n  const marquerCommeJoue = async (matchId, matchs) => {\n    const match = matchs.find(m => m.id === matchId);\n    if (!match) return;\n\n    setMatchToPlay(match);\n    setShowScoreModal(true);\n  };\n\n  const confirmerScoreEtJouer = async (matchs, setMatchs, showNotification) => {\n    if (!matchToPlay) return;\n\n    const scoreEquipe = parseInt(scoreEquipeInput) || 0;\n    const scoreAdversaire = parseInt(scoreAdversaireInput) || 0;\n\n    try {\n      // Vérifier si le match existe dans Firestore\n      const matchRef = doc(db, 'matchs', String(matchToPlay.id));\n      const matchDoc = await getDoc(matchRef);\n\n      if (matchDoc.exists()) {\n        // Mettre à jour\n        await updateDoc(matchRef, {\n          statut: 'joue',\n          score_equipe: scoreEquipe,\n          score_adversaire: scoreAdversaire,\n          updatedAt: new Date()\n        });\n      } else {\n        // Créer le document avec seulement les champs définis\n        const matchData = {\n          id: String(matchToPlay.id),\n          adversaire: matchToPlay.adversaire || '',\n          date: matchToPlay.date || '',\n          statut: 'joue',\n          score_equipe: scoreEquipe,\n          score_adversaire: scoreAdversaire,\n          createdAt: new Date(),\n          updatedAt: new Date()\n        };\n        \n        // Ajouter lieu seulement s'il existe\n        if (matchToPlay.lieu) {\n          matchData.lieu = matchToPlay.lieu;\n        }\n        \n        await setDoc(matchRef, matchData);\n      }\n\n      // Mettre à jour local\n      const updatedMatchs = matchs.map(m =>\n        m.id === matchToPlay.id\n          ? { ...m, statut: 'joue', score_equipe: scoreEquipe, score_adversaire: scoreAdversaire }\n          : m\n      );\n      setMatchs(updatedMatchs);\n\n      showNotification('✅ Match marqué comme joué', 'success');\n      setShowScoreModal(false);\n      setMatchToPlay(null);\n      setScoreEquipeInput('');\n      setScoreAdversaireInput('');\n    } catch (error) {\n      console.error('Erreur confirmerScoreEtJouer:', error);\n      showNotification('❌ Erreur lors de la mise à jour du match', 'error');\n    }\n  };\n\n  const repasserEnAttente = async (matchId, matchs, setMatchs, notes) => {\n    if (!window.confirm('Repasser ce match en attente ? Les notes seront supprimées.')) {\n      return;\n    }\n\n    try {\n      // Vérifier si le match existe dans Firestore\n      const matchRef = doc(db, 'matchs', String(matchId));\n      const matchDoc = await getDoc(matchRef);\n\n      if (matchDoc.exists()) {\n        await updateDoc(matchRef, {\n          statut: 'avenir',\n          score_equipe: null,\n          score_adversaire: null,\n          updatedAt: new Date()\n        });\n      }\n\n      // Supprimer les notes associées dans Firestore\n      const notesToDelete = notes.filter(n => n.id_match === matchId);\n      for (const note of notesToDelete) {\n        const noteRef = doc(db, 'notes', `${matchId}_${note.id_joueur}`);\n        const noteDoc = await getDoc(noteRef);\n        if (noteDoc.exists()) {\n          await deleteDoc(noteRef);\n        }\n      }\n\n      // Mettre à jour local\n      const updatedMatchs = matchs.map(m =>\n        m.id === matchId\n          ? { ...m, statut: 'avenir', score_equipe: null, score_adversaire: null }\n          : m\n      );\n      setMatchs(updatedMatchs);\n\n    } catch (error) {\n      console.error('Erreur repasserEnAttente:', error);\n    }\n  };\n\n  return {\n    selectedMatch,\n    setSelectedMatch,\n    showScoreModal,\n    setShowScoreModal,\n    matchToPlay,\n    scoreEquipeInput,\n    setScoreEquipeInput,\n    scoreAdversaireInput,\n    setScoreAdversaireInput,\n    marquerCommeJoue,\n    confirmerScoreEtJouer,\n    repasserEnAttente\n  };\n};\n\nexport default useMatchManagement;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}